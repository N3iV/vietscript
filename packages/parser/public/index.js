(function(b,e){typeof exports=="object"&&typeof module<"u"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(b=typeof globalThis<"u"?globalThis:b||self,e(b["@vietscript/parser"]={}))})(this,function(b){"use strict";var gt=Object.defineProperty;var Ot=(b,e,k)=>e in b?gt(b,e,{enumerable:!0,configurable:!0,writable:!0,value:k}):b[e]=k;var s=(b,e,k)=>(Ot(b,typeof e!="symbol"?e+"":e,k),k);var e=(n=>(n.VAR="Var",n.CONST="Const",n.LET="Let",n.IF="If",n.ELSE="Else",n.FOR="For",n.WHILE="While",n.DO="Do",n.BREAK="Break",n.CONTINUE="Continue",n.RETURN="Return",n.SWITCH="Switch",n.CASE="Case",n.DEFAULT="Default",n.TRY="Try",n.CATCH="Catch",n.FINALLY="Finally",n.THROW="Throw",n.FUNCTION="Function",n.CLASS="Class",n.INTERFACE="Interface",n.ENUM="Enum",n.TYPE="Type",n.IMPORT="Import",n.EXPORT="Export",n.FROM="From",n.AS="As",n.IN="In",n.OF="Of",n.IS="Is",n.NEW="New",n.THIS="This",n.SUPER="Super",n.TRUE="True",n.FALSE="False",n.NULL="Null",n.VOID="Void",n.ANY="Any",n.NUMBER="Number",n.STRING="String",n.BOOLEAN="Boolean",n.OBJECT="Object",n.ARRAY="Array",n.NAN="NaN",n.INFINITY="Infinity",n.UNDEFINED="Undefined",n.STATIC="Static",n.PUBLIC="Public",n.PRIVATE="Private",n.PROTECTED="Protected",n.ABSTRACT="Abstract",n.EXTENDS="Extends",n.IMPLEMENTS="Implements",n.GET="Get",n.SET="Set",n.CONSTRUCTOR="Constructor",n.YIELD="Yield",n.AWAIT="Await",n.ASYNC="Async",n.DELETE="Delete",n.TYPEOF="Typeof",n.INSTANCEOF="Instanceof",n.WITH="With",n.DEBUGGER="Debugger",n.IDENTIFIER="Identifier",n))(e||{});const k="\\u00C0\\u00C1\\u00C2\\u00C3\\u00C8\\u00C9\\u00CA\\u00CC\\u00CD\\u00D2\\u00D3\\u00D4\\u00D5\\u00D9\\u00DA\\u0102\\u0110\\u0128\\u0168\\u01A0\\u00E0\\u00E1\\u00E2\\u00E3\\u00E8\\u00E9\\u00EA\\u00EC\\u00ED\\u00F2\\u00F3\\u00F4\\u00F5\\u00F9\\u00FA\\u0103\\u0111\\u0129\\u0169\\u01A1\\u01AF\\u0102\\u1EA0\\u1EA2\\u1EA4\\u1EA6\\u1EA8\\u1EAA\\u1EAC\\u1EAE\\u1EB0\\u1EB2\\u1EB4\\u1EB6\\u1EB8\\u1EBA\\u1EBC\\u1EC0{2}\\u1EC2\\u01B0\\u0103\\u1EA1\\u1EA3\\u1EA5\\u1EA7\\u1EA9\\u1EAB\\u1EAD\\u1EAF\\u1EB1\\u1EB3\\u1EB5\\u1EB7\\u1EB9\\u1EBB\\u1EBD\\u1EC1{2}\\u1EC3\\u1EC4\\u1EC6\\u1EC8\\u1ECA\\u1ECC\\u1ECE\\u1ED0\\u1ED2\\u1ED4\\u1ED6\\u1ED8\\u1EDA\\u1EDC\\u1EDE\\u1EE0\\u1EE2\\u1EE4\\u1EE6\\u1EE8\\u1EEA\\u1EC5\\u1EC7\\u1EC9\\u1ECB\\u1ECD\\u1ECF\\u1ED1\\u1ED3\\u1ED5\\u1ED7\\u1ED9\\u1EDB\\u1EDD\\u1EDF\\u1EE1\\u1EE3\\u1EE5\\u1EE7\\u1EE9\\u1EEB\\u1EEC\\u1EEE\\u1EF0\\u1EF2\\u1EF4\\u00DD\\u1EF6\\u1EF8\\u1EED\\u1EEF\\u1EF1\\u1EF3\\u1EF5\\u1EF7\\u1EF9",F=[new RegExp(`^[a-zA-Z${k}]+(\\s[a-zA-Z${k}]+)*`),e.IDENTIFIER],R=[[/^\s+/,null],[/^\/\/.*/,null],[/^\/\*[\S\s]*?\*\//,null],[/^\[/,"["],[/^]/,"]"],[/^\(/,"("],[/^\)/,")"],[/^{/,"{"],[/^}/,"}"],[/^;/,";"],[/^,/,","],[/^===/,"==="],[/^==/,"=="],[/^!==/,"!=="],[/^!=/,"!="],[/^=/,"="],[/^\?/,"?"],[/^\?\.?/,"?."],[/^:/,":"],[/^\.{3}/,"..."],[/^\./,"."],[/^\+\+/,"++"],[/^\+/,"+"],[/^--/,"--"],[/^-/,"-"],[/^~/,"~"],[/^!/,"!"],[/^\*/,"*"],[/^\//,"/"],[/^%/,"%"],[/^\*\*/,"**"],[/^\?\?/,"??"],[/^#/,"#"],[/^>>>=/,">>>="],[/^>>>/,">>>"],[/^>>/,">>"],[/^>>=/,">>="],[/^<<=/,"<<="],[/^<</,"<<"],[/^<=/,"<="],[/^>=/,">="],[/^</,"<"],[/^>/,">"],[/^&&/,"&&"],[/^\|\|/,"||"],[/^&/,"&"],[/^\^/,"^"],[/^\|/,"|"],[/^\*=/,"*="],[/^\//,"/="],[/^%=/,"%="],[/^\+=/,"+="],[/^-=/,"-="],[/^&=/,"&="],[/^\^=/,"^="],[/^\|=/,"|="],[/^\*\*=/,"**="],[/^=>/,"=>"],[/^\b(var|khai b\u00E1o)\b/,e.VAR],[/^\b(break|ph\u00E1 v\u00F2ng l\u1EB7p)\b/,e.BREAK],[/^\b(do|th\u1EF1c hi\u1EC7n)\b/,e.DO],[/^\binstanceof\b/,e.INSTANCEOF],[/^\b(typeof|ki\u1EC3u c\u1EE7a)\b/,e.TYPEOF],[/^\b(switch|duy\u1EC7t)\b/,e.SWITCH],[/^\b(case|tr\u01B0\u1EDDng h\u1EE3p)\b/,e.CASE],[/^\b(if|n\u1EBFu)\b/,e.IF],[/^\b(else|kh\u00F4ng th\u00EC)/,e.ELSE],[/^\bnew\b/,e.NEW],[/^\b(catch|b\u1EAFt l\u1ED7i)\b/,e.CATCH],[/^\b(finally|cu\u1ED1i c\u00F9ng)\b/,e.FINALLY],[/^\b(return|tr\u1EA3 v\u1EC1)/,e.RETURN],[/^\bvoid\b/,e.VOID],[/^\b(continue|ti\u1EBFp t\u1EE5c)\b/,e.CONTINUE],[/^\bfor\b/,e.FOR],[/^\b(while|khi m\u00E0)\b/,e.WHILE],[/^\bdebugger\b/,e.DEBUGGER],[/^\b(function|h\u00E0m)\b/,e.FUNCTION],[/^\bthis\b/,e.THIS],[/^\bwith\b/,e.WITH],[/^\b(default|m\u1EB7c \u0111\u1ECBnh)\b/,e.DEFAULT],[/^\b(throw|b\u00E1o l\u1ED7i)\b/,e.THROW],[/^\b(delete|xo\u00E1)\b/,e.DELETE],[/^\b(in|trong)\b/,e.IN],[/^\b(try|th\u1EED)/,e.TRY],[/^\bas\b/,e.AS],[/^\b(from|t\u1EEB)\b/,e.FROM],[/^const|h\u1EB1ng s\u1ED1/,e.CONST],[/^\b(class|l\u1EDBp)\b/,e.CLASS],[/^\b(super|kh\u1EDFi t\u1EA1o cha)\b/,e.SUPER],[/^\b(constructor|kh\u1EDFi t\u1EA1o)\b/,e.CONSTRUCTOR],[/^\benum\b/,e.ENUM],[/^\b(extends|k\u1EBF th\u1EEBa)\b/,e.EXTENDS],[/^\b(export|xu\u1EA5t)\b/,e.EXPORT],[/^\b(import|nh\u1EADp)\b/,e.IMPORT],[/^\b(async|b\u1EA5t \u0111\u1ED3ng b\u1ED9)/,e.ASYNC],[/^\b(await|ch\u1EDD)\b/,e.AWAIT],[/^\byield\b/,e.YIELD],[/^\bimplements\b/,e.IMPLEMENTS],[/^\blet\b/,e.LET],[/^\bprivate\b/,e.PRIVATE],[/^\bpublic\b/,e.PUBLIC],[/^\binterface\b/,e.INTERFACE],[/^\bprotected\b/,e.PROTECTED],[/^\bstatic\b/,e.STATIC],[/^(\d+(\.|)(\d+|)([Ee]([+-]|)\d+|))/,e.NUMBER],[/^"[^"]*"/,e.STRING],[/^'[^']*'/,e.STRING],[/^`[^`]*`/,e.STRING],[/^\bnull\b/,e.NULL],[/^\bNaN\b/,e.NAN],[/^\b(undefined|kh\u00F4ng x\u00E1c \u0111\u1ECBnh)\b/,e.UNDEFINED],[/(true|false|\u0111\u00FAng|sai)\b/,e.BOOLEAN],F];class N{constructor(t){s(this,"parser");s(this,"cursor");this.parser=t,this.cursor=0}isEOF(){return this.cursor===this.parser.syntax.length}hasMoreTokens(){return this.cursor<this.parser.syntax.length}getNextToken(t=!1){if(!this.hasMoreTokens())return null;const a=this.parser.syntax.slice(this.cursor);for(const[i,c]of R){const o=this.match(i,a);if(o!==null)return c===null?this.getNextToken():{type:c,value:o,start:this.cursor-String(o).length,end:this.cursor}}throw new SyntaxError(`Unexpected token: "${a[0]}"`)}match(t,a){const i=t.exec(a);return i===null?null:(this.cursor+=i[0].length,i[0])}}class L{constructor(t){s(this,"type","EmptyStatement");t.eat(";")}}class h{constructor(t){s(this,"type","Identifier");s(this,"name");var a;this.name=String((a=t.eat(e.IDENTIFIER))==null?void 0:a.value)}}class x{constructor(t){s(this,"type","BooleanLiteral");s(this,"value");s(this,"start");s(this,"end");const a=t.eat(e.BOOLEAN);this.start=a.start,this.end=a.end;const i=a.value==="true"?!0:a.value==="đúng";this.value=i}}class r{constructor(t){s(this,"type",e.IDENTIFIER);s(this,"name",e.NAN);s(this,"start");s(this,"end");const a=t.eat(e.NAN);this.start=a.start,this.end=a.end}}class B{constructor(t){s(this,"type","NullLiteral");s(this,"start");s(this,"end");const a=t.eat(e.NULL);this.start=a.start,this.end=a.end}}class U{constructor(t){s(this,"type","NumericLiteral");s(this,"value");s(this,"extra");s(this,"start");s(this,"end");const a=t.eat(e.NUMBER);this.start=a.start,this.end=a.end,this.value=Number(a.value),this.extra={rawValue:this.value,raw:String(a.value)}}}class j{constructor(t){s(this,"type","StringLiteral");s(this,"value");s(this,"extra");s(this,"start");s(this,"end");const a=t.eat(e.STRING);this.start=a.start,this.end=a.end;const i=String(a.value).slice(1,-1);this.value=i,this.extra={rawValue:i,raw:JSON.stringify(i)}}}class p{constructor(t){s(this,"type",e.IDENTIFIER);s(this,"name",e.UNDEFINED);s(this,"start");s(this,"end");const a=t.eat(e.UNDEFINED);this.start=a.start,this.end=a.end}}class v{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case e.NUMBER:{Object.assign(this,new U(t));break}case e.STRING:{Object.assign(this,new j(t));break}case e.BOOLEAN:{Object.assign(this,new x(t));break}case e.NULL:{Object.assign(this,new B(t));break}case e.NAN:{Object.assign(this,new r(t));break}case e.UNDEFINED:{Object.assign(this,new p(t));break}}}}class d{constructor(t){s(this,"type","BlockStatement");s(this,"body");const a=[];t.eat("{"),a.push(...new T(t,["}"]).body),t.eat("}"),this.body=a}}class W{constructor(t){s(this,"type","DoWhileStatement");s(this,"body");s(this,"test");t.eat(e.DO),this.body=new d(t),t.eat(e.WHILE),t.eat("("),this.test=new u(t),t.eat(")")}}class H{constructor(t){s(this,"type","BreakStatement");s(this,"label");var i;t.eat(e.BREAK);let a=null;((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER&&(a=new h(t).name),this.label=a}}class Y{constructor(t){s(this,"type","ContinueStatement");s(this,"label");var i;t.eat(e.BREAK);let a=null;((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER&&(a=new h(t).name),this.label=a}}class P{constructor(t){s(this,"type","ReturnStatement");s(this,"argument");t.eat(e.RETURN);const a=new u(t);this.argument=a}}class M{constructor(t){s(this,"type","ThrowStatement");s(this,"argument");t.eat(e.THROW);const a=new u(t);this.argument=a}}class G{constructor(t){s(this,"type","DebuggerStatement");t.eat(e.DEBUGGER)}}class V{constructor(t){s(this,"type","SwitchStatement");s(this,"discriminant");s(this,"cases",[]);var a,i,c;for(t.eat(e.SWITCH),t.eat("("),this.discriminant=new u(t),t.eat(")"),t.eat("{");![e.DEFAULT,"}"].includes((a=t.lookahead)==null?void 0:a.type);){let o=!1;t.eat(e.CASE);const l=new u(t);for(t.eat(":");![e.CASE,e.DEFAULT,"}"].includes((i=t.lookahead)==null?void 0:i.type);)this.cases.push({type:"SwitchCase",test:l,consequent:new T(t,[e.CASE,e.DEFAULT,"}"]).body}),o=!0;o||this.cases.push({type:"SwitchCase",test:l,consequent:[]})}((c=t.lookahead)==null?void 0:c.type)===e.DEFAULT&&(t.eat(e.DEFAULT),t.eat(":"),this.cases.push({type:"SwitchCase",test:null,consequent:new T(t).body})),t.eat("}")}}class z{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case e.DO:case e.WHILE:case e.FOR:{Object.assign(this,new A(t));break}case e.SWITCH:{Object.assign(this,new V(t));break}}}}class f{constructor(t){s(this,"type","IfStatement");s(this,"test");s(this,"consequent");s(this,"alternate");var a,i,c,o,l;t.eat(e.IF),t.eat("("),this.test=((a=t.lookahead)==null?void 0:a.type)===e.IDENTIFIER?new h(t):new u(t),t.eat(")"),this.consequent=((i=t.lookahead)==null?void 0:i.type)==="{"?new d(t):new y(t),((c=t.lookahead)==null?void 0:c.type)===e.ELSE&&(t.eat(e.ELSE),((o=t.lookahead)==null?void 0:o.type)===e.IF?this.alternate=new f(t):this.alternate=((l=t.lookahead)==null?void 0:l.type)==="{"?new d(t):new y(t))}}class ${constructor(t){s(this,"type","CatchClause");s(this,"body");s(this,"param",null);var a;t.eat(e.CATCH),((a=t.lookahead)==null?void 0:a.type)==="("&&(t.eat("("),this.param=new h(t),t.eat(")")),this.body=new d(t)}}class q{constructor(t){s(this,"type","TryStatement");s(this,"block");s(this,"handler",null);s(this,"finalizer",null);var a,i,c,o;if(t.eat(e.TRY),this.block=new d(t),((a=t.lookahead)==null?void 0:a.type)!==e.CATCH&&((i=t.lookahead)==null?void 0:i.type)!==e.FINALLY)throw new Error("Expected Catch or Finally");((c=t.lookahead)==null?void 0:c.type)===e.CATCH&&(this.handler=new $(t)),((o=t.lookahead)==null?void 0:o.type)===e.FINALLY&&(t.eat(e.FINALLY),this.finalizer=new d(t))}}class X{constructor(t){s(this,"type","WithStatement");t.eat(e.WITH)}}class J{constructor(t){s(this,"type","ExpressionStatement");s(this,"expression");this.expression=new u(t)}}class y{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case"{":{Object.assign(this,new d(t));break}case e.IF:{Object.assign(this,new f(t));break}case e.DO:case e.WHILE:case e.FOR:case e.SWITCH:{Object.assign(this,new z(t));break}case e.CONTINUE:{Object.assign(this,new Y(t));break}case e.BREAK:{Object.assign(this,new H(t));break}case e.RETURN:{Object.assign(this,new P(t));break}case e.WITH:{Object.assign(this,new X(t));break}case e.THROW:{Object.assign(this,new M(t));break}case e.TRY:{Object.assign(this,new q(t));break}case e.DEBUGGER:{Object.assign(this,new G(t));break}default:{Object.assign(this,new J(t));break}}}}class Z{constructor(t){s(this,"type","WhileStatement");s(this,"body");s(this,"test");var a;t.eat(e.WHILE),t.eat("("),this.test=new u(t),t.eat(")"),this.body=((a=t.lookahead)==null?void 0:a.type)==="{"?new d(t):new y(t)}}class _{constructor(t,a=!1){s(this,"type","VariableDeclarator");s(this,"id");s(this,"init",{type:e.IDENTIFIER,name:"undefined"});var c;const i=new h(t);(a||((c=t.lookahead)==null?void 0:c.type)==="=")&&(t.eat("="),this.init=new u(t)),this.id=i}}class w{constructor(t){s(this,"type","VariableDeclaration");s(this,"declarations");s(this,"kind");var o,l,E;let a="var",i=!1;switch((o=t.lookahead)==null?void 0:o.type){case e.VAR:{t.eat(e.VAR),a="var";break}case e.LET:{t.eat(e.LET),a="let";break}case e.CONST:{t.eat(e.CONST),a="const",i=!0;break}default:throw new SyntaxError(`Unexpected token: "${(l=t.lookahead)==null?void 0:l.value}", expected a variable declarator!`)}const c=[];do c.push(new _(t,i));while(((E=t.lookahead)==null?void 0:E.type)===","&&t.eat(","));this.declarations=c,this.kind=a}}class Q{constructor(t){s(this,"type","ForStatement");s(this,"init");s(this,"test");s(this,"update");s(this,"body");var i,c,o,l,E,I,D;t.eat(e.FOR);let a=!1;if(((i=t.lookahead)==null?void 0:i.type)===e.AWAIT&&(t.eat(e.AWAIT),a=!0),t.eat("("),!a&&((c=t.lookahead)==null?void 0:c.type)!==e.IN&&((o=t.lookahead)==null?void 0:o.type)!==e.OF){switch((l=t.lookahead)==null?void 0:l.type){case e.VAR:case e.LET:{this.init=new w(t);break}case e.CONST:throw new Error("Const declarations are not allowed in for loops");default:{this.init=new h(t);break}}t.eat(";"),this.test=new u(t),((E=t.lookahead)==null?void 0:E.type)===";"&&t.eat(";"),((I=t.lookahead)==null?void 0:I.type)!==")"&&(this.update=new u(t))}else throw new Error("For loop with in or of is not implemented");t.eat(")"),this.body=((D=t.lookahead)==null?void 0:D.type)==="{"?new d(t):new y(t)}}class A{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case e.DO:{Object.assign(this,new W(t));break}case e.WHILE:{Object.assign(this,new Z(t));break}case e.FOR:{Object.assign(this,new Q(t));break}}}}class K{constructor(t,a){s(this,"type","LabelledStatement");s(this,"label");s(this,"body");this.label=a,t.eat(":"),this.body=new A(t)}}class tt{constructor(t,a="]"){s(this,"type","ArrayElementList");s(this,"elements",[]);var i,c;for(;((i=t.lookahead)==null?void 0:i.type)!==a;)this.elements.push(new u(t)),((c=t.lookahead)==null?void 0:c.type)!==a&&t.eat(",")}}class et{constructor(t){s(this,"type","ArrayLiteral");s(this,"elements");t.eat("["),this.elements=new tt(t,"]").elements,t.eat("]")}}class st{constructor(t){s(this,"type","ArrayExpression");s(this,"elements");this.elements=new et(t).elements}}class S{constructor(t,a=!1){s(this,"type","FunctionExpression");s(this,"id");s(this,"expression",!1);s(this,"generator",!1);s(this,"async",!1);s(this,"params");s(this,"body");var o,l,E;((o=t.lookahead)==null?void 0:o.type)===e.ASYNC&&(t.eat(e.ASYNC),this.async=!0),a||t.eat(e.FUNCTION),((l=t.lookahead)==null?void 0:l.type)==="*"&&(t.eat("*"),this.generator=!0),t.eat("(");const i=[];for(;((E=t.lookahead)==null?void 0:E.type)!==")";)i.length>0&&t.eat(","),i.push(new h(t));t.eat(")");const c=new d(t);this.id=null,this.expression=!1,this.params=i,this.body=c}}class at{constructor(t,a){s(this,"type","BinaryExpression");s(this,"left");s(this,"operator");s(this,"right");var i,c,o,l;switch(this.left=a??(((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER?new h(t):new u(t)),(c=t.lookahead)==null?void 0:c.type){case"+":case"-":case"*":case"/":case"%":case"**":case"^":case">":case">>":case">>>":case"<":case"<<":case"<<<":case">=":case"<=":case"==":case"===":{this.operator=String(t.eat((o=t.lookahead)==null?void 0:o.type).value);break}}this.right=((l=t.lookahead)==null?void 0:l.type)===e.IDENTIFIER?new h(t):new u(t)}}class m{constructor(t,a){s(this,"type","AssignmentExpression");s(this,"left");s(this,"operator");s(this,"right");var i,c;this.left=a??(((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER?new h(t):new u(t)),this.operator=String(t.eat("=").value),this.right=((c=t.lookahead)==null?void 0:c.type)===e.IDENTIFIER?new h(t):new u(t)}}class nt{constructor(t){s(this,"type","UpdateExpression");s(this,"operator");s(this,"argument");s(this,"prefix");var a,i,c;((a=t.lookahead)==null?void 0:a.type)==="++"||((i=t.lookahead)==null?void 0:i.type)==="--"?(this.prefix=!0,this.operator=String(t.eat(t.lookahead.type).value),this.argument=new h(t)):((c=t.lookahead)==null?void 0:c.type)===e.IDENTIFIER&&(this.argument=new h(t),this.prefix=!1,this.operator=String(t.eat(t.lookahead.type).value))}}class it{constructor(t){s(this,"type","UnaryExpression");s(this,"operator");s(this,"prefix");s(this,"argument");var a,i;switch((a=t.lookahead)==null?void 0:a.type){case"delete":case"void":case"typeof":case"+":case"-":case"~":case"!":{this.operator=String(t.eat((i=t.lookahead)==null?void 0:i.type).value),this.prefix=!0,this.argument=new u(t);break}}}}class ct{constructor(t,a){s(this,"type","LogicalExpression");s(this,"left");s(this,"operator");s(this,"right");var i,c,o,l;switch(this.left=a??(((i=t.lookahead)==null?void 0:i.type)===e.IDENTIFIER?new h(t):new u(t)),(c=t.lookahead)==null?void 0:c.type){case"??":case"||":case"&&":{this.operator=String(t.eat((o=t.lookahead)==null?void 0:o.type).value);break}}this.right=((l=t.lookahead)==null?void 0:l.type)===e.IDENTIFIER?new h(t):new u(t)}}class ot{constructor(t){s(this,"type","AwaitExpression");s(this,"argument");t.eat(e.AWAIT),this.argument=new u(t)}}class lt{constructor(t){s(this,"type","ThisExpression");t.eat(e.THIS)}}class C{constructor(t,a){s(this,"type","MemberExpression");s(this,"object");s(this,"property",null);s(this,"computed",!1);s(this,"optional",!1);var i,c,o;this.object=a;do switch((i=t.lookahead)==null?void 0:i.type){case"[":{t.eat("["),this.object=this.property?{...this}:{...this.object},this.property=new u(t),t.eat("]"),this.computed=!0;break}case".":{t.eat("."),this.object=this.property?{...this}:{...this.object},this.property=new h(t),this.computed=!1;break}}while(((c=t.lookahead)==null?void 0:c.type)==="."||((o=t.lookahead)==null?void 0:o.type)==="[")}}class ut{constructor(t){s(this,"type","ObjectProperty");s(this,"method",!1);s(this,"computed",!1);s(this,"key");s(this,"value");var a,i;((a=t.lookahead)==null?void 0:a.type)==="["?(t.eat("["),this.key=new u(t),this.computed=!0,t.eat("]")):this.key=new h(t),((i=t.lookahead)==null?void 0:i.type)===":"?(t.eat(":"),this.value=new u(t)):this.value=null}}class ht{constructor(t){s(this,"type","ObjectMethod");s(this,"method",!0);s(this,"key");s(this,"computed",!1);s(this,"kind","method");s(this,"generator",!1);s(this,"async",!1);s(this,"params",[]);s(this,"body");var i,c;switch((i=t.lookahead)==null?void 0:i.type){case e.GET:{t.eat(e.GET),this.kind="get",this.method=!1;break}case e.SET:{t.eat(e.SET),this.kind="set",this.method=!1;break}case e.ASYNC:{t.eat(e.ASYNC),this.async=!0;break}}((c=t.lookahead)==null?void 0:c.type)==="["?(t.eat("["),this.key=new u(t),this.computed=!0,t.eat("]")):this.key=new h(t);const a=new S(t,!0);this.generator=a.generator,this.params=a.params,this.body=a.body}}class Et{constructor(t,a="}"){s(this,"properties",[]);var i,c,o;for(;((i=t.lookahead)==null?void 0:i.type)!==a;){switch((c=t.lookahead)==null?void 0:c.type){case e.GET:case e.SET:case e.ASYNC:{this.properties.push(new ht(t));break}default:this.properties.push(new ut(t))}((o=t.lookahead)==null?void 0:o.type)!==a&&t.eat(",")}}}class bt{constructor(t){s(this,"type","ObjectLiteral");s(this,"properties",[]);t.eat("{"),this.properties=new Et(t).properties,t.eat("}")}}class dt{constructor(t){s(this,"type","ObjectExpression");s(this,"properties",[]);this.properties=new bt(t).properties}}class kt{constructor(t,a){s(this,"type","CallExpression");s(this,"callee");s(this,"arguments",[]);s(this,"optional",!1);var i;for(this.callee=a,t.eat("(");((i=t.lookahead)==null?void 0:i.type)!==")";)this.arguments.length>0&&t.eat(","),this.arguments.push(new u(t));t.eat(")")}}class u{constructor(t){var a,i,c,o;switch((a=t.lookahead)==null?void 0:a.type){case e.ASYNC:case e.FUNCTION:{Object.assign(this,new S(t));break}case"[":{Object.assign(this,new st(t));break}case"{":{Object.assign(this,new dt(t));break}case e.NUMBER:case e.STRING:case e.BOOLEAN:case e.NAN:case e.NULL:case e.UNDEFINED:{Object.assign(this,new v(t));break}case"++":case"--":{Object.assign(this,new nt(t));break}case"delete":case"void":case"typeof":case"+":case"-":case"~":case"!":{Object.assign(this,new it(t));break}case e.AWAIT:{Object.assign(this,new ot(t));break}case e.THIS:{Object.assign(this,new lt(t)),((i=t.lookahead)==null?void 0:i.type)==="."&&Object.assign(this,new C(t,this));break}case e.IDENTIFIER:{const l=new h(t);switch((c=t.lookahead)==null?void 0:c.type){case"+":case"-":case"*":case"/":case"%":case"**":case"^":case">":case">>":case">>>":case"<":case"<<":case"<<<":case">=":case"<=":case"==":case"===":{Object.assign(this,new at(t,l));break}case"=":{Object.assign(this,new m(t,l));break}case"??":case"||":case"&&":{Object.assign(this,new ct(t,l));break}case":":{Object.assign(this,new K(t,l));break}case"[":case".":{const E=new C(t,l);switch((o=t.lookahead)==null?void 0:o.type){case"=":{Object.assign(this,new m(t,E));break}case"(":{Object.assign(this,new kt(t,E));break}default:{Object.assign(this,E);break}}break}default:{Object.assign(this,l);break}}break}}}}class yt{constructor(t,a=!1){s(this,"type","ClassMethod");s(this,"async",!1);s(this,"static",!1);s(this,"computed",!1);s(this,"key");s(this,"kind","method");s(this,"value");var i,c;switch(this.static=a,(i=t.lookahead)==null?void 0:i.type){case e.GET:{t.eat(e.GET),this.kind="get";break}case e.SET:{t.eat(e.SET),this.kind="set";break}case e.ASYNC:{t.eat(e.ASYNC),this.async=!0;break}}((c=t.lookahead)==null?void 0:c.type)==="["?(t.eat("["),this.key=new u(t),this.computed=!0,t.eat("]")):this.key=new h(t),this.value=new S(t,!0)}}class It{constructor(t){s(this,"type","ClassProperty");s(this,"static",!1);s(this,"computed",!1);s(this,"key");s(this,"value");var a,i,c,o;switch(((a=t.lookahead)==null?void 0:a.type)===e.STATIC&&(t.eat(e.STATIC),this.static=!0),(i=t.lookahead)==null?void 0:i.type){case e.GET:case e.SET:case e.ASYNC:{Object.assign(this,new yt(t));break}default:((c=t.lookahead)==null?void 0:c.type)==="["?(t.eat("["),this.key=new u(t),this.computed=!0,t.eat("]")):this.key=new h(t),((o=t.lookahead)==null?void 0:o.type)==="="?(t.eat("="),this.value=new u(t)):this.value=null}}}class Tt{constructor(t){s(this,"type","ClassElementList");s(this,"properties",[]);var a;for(;((a=t.lookahead)==null?void 0:a.type)!=="}";)this.properties.push(new It(t))}}class Nt{constructor(t){s(this,"type","ClassBody");s(this,"body",[]);t.eat("{"),this.body=new Tt(t).properties,t.eat("}")}}class ft{constructor(t){s(this,"type","ClassDeclaration");s(this,"id");s(this,"superClass",null);s(this,"body");var a;t.eat(e.CLASS),this.id=new h(t),((a=t.lookahead)==null?void 0:a.type)==="("&&(t.eat("("),this.superClass=new h(t),t.eat(")")),this.body=new Nt(t)}}class St{constructor(t,a=")"){s(this,"parameters",[]);var i,c;for(;((i=t.lookahead)==null?void 0:i.type)!==a;)this.parameters.push(new h(t)),((c=t.lookahead)==null?void 0:c.type)!==a&&t.eat(",")}}class wt{constructor(t){s(this,"type","FunctionDeclaration");s(this,"id");s(this,"expression");s(this,"generator");s(this,"async");s(this,"params");s(this,"body");var E,I;let a=!1,i=!1;((E=t.lookahead)==null?void 0:E.type)===e.ASYNC&&(t.eat(e.ASYNC),a=!0),t.eat(e.FUNCTION),((I=t.lookahead)==null?void 0:I.type)==="*"&&(t.eat("*"),i=!0);const c=String(new h(t).name);t.eat("(");const o=new St(t,")").parameters;t.eat(")");const l=new d(t);this.id={type:e.IDENTIFIER,name:c},this.expression=!1,this.generator=i,this.async=a,this.params=o,this.body=l}}class At{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case e.VAR:case e.LET:case e.CONST:{Object.assign(this,new w(t));break}case e.ASYNC:case e.FUNCTION:{Object.assign(this,new wt(t));break}case e.CLASS:{Object.assign(this,new ft(t));break}}}}class mt{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case e.VAR:case e.LET:case e.CONST:case e.ASYNC:case e.FUNCTION:case e.CLASS:{Object.assign(this,new At(t));break}case e.IF:case e.DO:case e.WHILE:case e.FOR:case e.SWITCH:case e.CONTINUE:case e.BREAK:case e.RETURN:case e.WITH:case e.IDENTIFIER:case e.THROW:case e.TRY:case e.DEBUGGER:{Object.assign(this,new y(t));break}}}}class T{constructor(t,a){s(this,"body");var c,o,l;const i=[];for(;t.tokenizer.isEOF()===!1&&!(a!=null&&a.includes(String((c=t.lookahead)==null?void 0:c.type)));){const E=new mt(t);for(E!==void 0&&i.push(E),((o=t.lookahead)==null?void 0:o.type)===";"&&t.eat(";");((l=t.lookahead)==null?void 0:l.type)===";";)i.push(new L(t))}this.body=i}}class Ct{constructor(t){s(this,"type","Program");s(this,"body");this.body=new T(t).body}}class g{constructor(){s(this,"syntax");s(this,"tokenizer");s(this,"lookahead");this.syntax="",this.tokenizer=new N(this),this.lookahead=null}parse(t){return this.lookahead=null,this.syntax="",this.syntax=t,this.tokenizer=new N(this),this.lookahead=this.tokenizer.getNextToken(),new Ct(this)}eat(t){const a=this.lookahead;if(a===null)throw new SyntaxError(`Unexpected end of input, expected: "${t}"`);if(a.type!==t)switch(t){case e.IDENTIFIER:throw new SyntaxError(`Unexpected token: "${a.value}", cannot use keyword "${a.value}" for the beginning of the identifer`);default:throw new SyntaxError(`Unexpected token: "${a.value}", expected: "${t}"`)}return this.lookahead=this.tokenizer.getNextToken(t===e.IDENTIFIER),a}}const O=new g;typeof window<"u"&&(customElements.define("vi-script",class extends HTMLElement{constructor(){super()}connectedCallback(){setTimeout(()=>{var n;(n=this.childNodes.item(0).textContent)==null||n.trim(),this.innerHTML=""})}}),window.VietScript={parser:O}),b.Parser=g,b.Tokenizer=N,b.default=O,Object.defineProperties(b,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
