(function(k,i){typeof exports=="object"&&typeof module<"u"?i(exports):typeof define=="function"&&define.amd?define(["exports"],i):(k=typeof globalThis<"u"?globalThis:k||self,i(k["@vietscript/parser"]={}))})(this,function(k){"use strict";var At=Object.defineProperty;var Dt=(k,i,m)=>i in k?At(k,i,{enumerable:!0,configurable:!0,writable:!0,value:m}):k[i]=m;var e=(k,i,m)=>(Dt(k,typeof i!="symbol"?i+"":i,m),m);var i=(n=>(n.VAR="Var",n.CONST="Const",n.LET="Let",n.IF="If",n.ELSE="Else",n.FOR="For",n.WHILE="While",n.DO="Do",n.BREAK="Break",n.CONTINUE="Continue",n.RETURN="Return",n.SWITCH="Switch",n.CASE="Case",n.DEFAULT="Default",n.TRY="Try",n.CATCH="Catch",n.FINALLY="Finally",n.THROW="Throw",n.FUNCTION="Function",n.CLASS="Class",n.INTERFACE="Interface",n.ENUM="Enum",n.TYPE="Type",n.IMPORT="Import",n.EXPORT="Export",n.FROM="From",n.AS="As",n.IN="In",n.OF="Of",n.IS="Is",n.NEW="New",n.THIS="This",n.SUPER="Super",n.TRUE="True",n.FALSE="False",n.NULL="Null",n.VOID="Void",n.ANY="Any",n.NUMBER="Number",n.STRING="String",n.BOOLEAN="Boolean",n.OBJECT="Object",n.ARRAY="Array",n.NAN="NaN",n.INFINITY="Infinity",n.UNDEFINED="Undefined",n.STATIC="Static",n.PUBLIC="Public",n.PRIVATE="Private",n.PROTECTED="Protected",n.ABSTRACT="Abstract",n.EXTENDS="Extends",n.IMPLEMENTS="Implements",n.GET="Get",n.SET="Set",n.CONSTRUCTOR="Constructor",n.YIELD="Yield",n.AWAIT="Await",n.ASYNC="Async",n.DELETE="Delete",n.TYPEOF="Typeof",n.INSTANCEOF="Instanceof",n.WITH="With",n.DEBUGGER="Debugger",n.IDENTIFIER="Identifier",n))(i||{});const m="\\u00C0\\u00C1\\u00C2\\u00C3\\u00C8\\u00C9\\u00CA\\u00CC\\u00CD\\u00D2\\u00D3\\u00D4\\u00D5\\u00D9\\u00DA\\u0102\\u0110\\u0128\\u0168\\u01A0\\u00E0\\u00E1\\u00E2\\u00E3\\u00E8\\u00E9\\u00EA\\u00EC\\u00ED\\u00F2\\u00F3\\u00F4\\u00F5\\u00F9\\u00FA\\u0103\\u0111\\u0129\\u0169\\u01A1\\u01AF\\u0102\\u1EA0\\u1EA2\\u1EA4\\u1EA6\\u1EA8\\u1EAA\\u1EAC\\u1EAE\\u1EB0\\u1EB2\\u1EB4\\u1EB6\\u1EB8\\u1EBA\\u1EBC\\u1EC0{2}\\u1EC2\\u01B0\\u0103\\u1EA1\\u1EA3\\u1EA5\\u1EA7\\u1EA9\\u1EAB\\u1EAD\\u1EAF\\u1EB1\\u1EB3\\u1EB5\\u1EB7\\u1EB9\\u1EBB\\u1EBD\\u1EC1{2}\\u1EC3\\u1EC4\\u1EC6\\u1EC8\\u1ECA\\u1ECC\\u1ECE\\u1ED0\\u1ED2\\u1ED4\\u1ED6\\u1ED8\\u1EDA\\u1EDC\\u1EDE\\u1EE0\\u1EE2\\u1EE4\\u1EE6\\u1EE8\\u1EEA\\u1EC5\\u1EC7\\u1EC9\\u1ECB\\u1ECD\\u1ECF\\u1ED1\\u1ED3\\u1ED5\\u1ED7\\u1ED9\\u1EDB\\u1EDD\\u1EDF\\u1EE1\\u1EE3\\u1EE5\\u1EE7\\u1EE9\\u1EEB\\u1EEC\\u1EEE\\u1EF0\\u1EF2\\u1EF4\\u00DD\\u1EF6\\u1EF8\\u1EED\\u1EEF\\u1EF1\\u1EF3\\u1EF5\\u1EF7\\u1EF9",U=[new RegExp(`^[a-zA-Z${m}]+(\\s[a-zA-Z${m}]+)*`),i.IDENTIFIER],p=[[/^\s+/,null],[/^\/\/.*/,null],[/^\/\*[\S\s]*?\*\//,null],[/^\[/,"["],[/^]/,"]"],[/^\(/,"("],[/^\)/,")"],[/^{/,"{"],[/^}/,"}"],[/^;/,";"],[/^,/,","],[/^===/,"==="],[/^==/,"=="],[/^!==/,"!=="],[/^!=/,"!="],[/^=/,"="],[/^\?/,"?"],[/^\?\.?/,"?."],[/^:/,":"],[/^\.{3}/,"..."],[/^\./,"."],[/^\+\+/,"++"],[/^\+/,"+"],[/^--/,"--"],[/^-/,"-"],[/^~/,"~"],[/^!/,"!"],[/^\*/,"*"],[/^\//,"/"],[/^%/,"%"],[/^\*\*/,"**"],[/^\?\?/,"??"],[/^#/,"#"],[/^>>>=/,">>>="],[/^>>>/,">>>"],[/^>>/,">>"],[/^>>=/,">>="],[/^<<=/,"<<="],[/^<</,"<<"],[/^<=/,"<="],[/^>=/,">="],[/^</,"<"],[/^>/,">"],[/^&&/,"&&"],[/^\|\|/,"||"],[/^&/,"&"],[/^\^/,"^"],[/^\|/,"|"],[/^\*=/,"*="],[/^\//,"/="],[/^%=/,"%="],[/^\+=/,"+="],[/^-=/,"-="],[/^&=/,"&="],[/^\^=/,"^="],[/^\|=/,"|="],[/^\*\*=/,"**="],[/^=>/,"=>"],[/^\b(var|khai b\u00E1o)\b/,i.VAR],[/^\b(break|ph\u00E1 v\u00F2ng l\u1EB7p)\b/,i.BREAK],[/^\b(do|th\u1EF1c hi\u1EC7n)\b/,i.DO],[/^\binstanceof\b/,i.INSTANCEOF],[/^\b(typeof|ki\u1EC3u c\u1EE7a)\b/,i.TYPEOF],[/^\b(switch|duy\u1EC7t)\b/,i.SWITCH],[/^\b(case|tr\u01B0\u1EDDng h\u1EE3p)\b/,i.CASE],[/^\b(if|n\u1EBFu)\b/,i.IF],[/^\b(else|kh\u00F4ng th\u00EC)/,i.ELSE],[/^\bnew\b/,i.NEW],[/^\b(catch|b\u1EAFt l\u1ED7i)\b/,i.CATCH],[/^\b(finally|cu\u1ED1i c\u00F9ng)\b/,i.FINALLY],[/^\b(return|tr\u1EA3 v\u1EC1)/,i.RETURN],[/^\bvoid\b/,i.VOID],[/^\b(continue|ti\u1EBFp t\u1EE5c)\b/,i.CONTINUE],[/^\bfor\b/,i.FOR],[/^\b(while|khi m\u00E0)\b/,i.WHILE],[/^\bdebugger\b/,i.DEBUGGER],[/^\b(function|h\u00E0m)\b/,i.FUNCTION],[/^\bthis\b/,i.THIS],[/^\bwith\b/,i.WITH],[/^\b(default|m\u1EB7c \u0111\u1ECBnh)\b/,i.DEFAULT],[/^\b(throw|b\u00E1o l\u1ED7i)\b/,i.THROW],[/^\b(delete|xo\u00E1)\b/,i.DELETE],[/^\b(in|trong)\b/,i.IN],[/^\b(try|th\u1EED)/,i.TRY],[/^\bas\b/,i.AS],[/^\b(from|t\u1EEB)\b/,i.FROM],[/^const|h\u1EB1ng s\u1ED1/,i.CONST],[/^\b(class|l\u1EDBp)\b/,i.CLASS],[/^\b(super|kh\u1EDFi t\u1EA1o cha)\b/,i.SUPER],[/^\b(constructor|kh\u1EDFi t\u1EA1o)\b/,i.CONSTRUCTOR],[/^\benum\b/,i.ENUM],[/^\b(extends|k\u1EBF th\u1EEBa)\b/,i.EXTENDS],[/^\b(export|xu\u1EA5t)\b/,i.EXPORT],[/^\b(import|nh\u1EADp)\b/,i.IMPORT],[/^\b(async|b\u1EA5t \u0111\u1ED3ng b\u1ED9)/,i.ASYNC],[/^\b(await|ch\u1EDD)\b/,i.AWAIT],[/^\byield\b/,i.YIELD],[/^\bimplements\b/,i.IMPLEMENTS],[/^\blet\b/,i.LET],[/^\bprivate\b/,i.PRIVATE],[/^\bpublic\b/,i.PUBLIC],[/^\binterface\b/,i.INTERFACE],[/^\bprotected\b/,i.PROTECTED],[/^\bstatic\b/,i.STATIC],[/^(\d+(\.|)(\d+|)([Ee]([+-]|)\d+|))/,i.NUMBER],[/^"[^"]*"/,i.STRING],[/^'[^']*'/,i.STRING],[/^`[^`]*`/,i.STRING],[/^\bnull\b/,i.NULL],[/^\bNaN\b/,i.NAN],[/^\b(undefined|kh\u00F4ng x\u00E1c \u0111\u1ECBnh)\b/,i.UNDEFINED],[/^\b(true|false)\b/,i.BOOLEAN],U];class T{constructor(t){e(this,"parser");e(this,"cursor");this.parser=t,this.cursor=0}isEOF(){return this.cursor===this.parser.syntax.length}hasMoreTokens(){return this.cursor<this.parser.syntax.length}getNextToken(t=!1){if(!this.hasMoreTokens())return null;const a=this.parser.syntax.slice(this.cursor);for(const[s,o]of p){const c=this.match(s,a);if(c!==null)return o===null?this.getNextToken():{type:o,value:c,start:this.cursor-String(c).length,end:this.cursor}}throw new SyntaxError(`Unexpected token: "${a[0]}"`)}match(t,a){const s=t.exec(a);return s===null?null:(this.cursor+=s[0].length,s[0])}}class W{constructor(t){e(this,"type","EmptyStatement");t.eat(";")}}class h{constructor(t){e(this,"type","Identifier");e(this,"name");var a;this.name=String((a=t.eat("Identifier"))==null?void 0:a.value)}}class y{constructor(t){e(this,"type","BlockStatement");e(this,"body");const a=[];t.eat("{"),a.push(...new D(t,["}"]).body),t.eat("}"),this.body=a}}class I{constructor(t,a=!1,s=!1){e(this,"type","FunctionExpression");e(this,"id");e(this,"expression");e(this,"generator");e(this,"async");e(this,"params");e(this,"body");var d,b,f;let o=s,c=!1;((d=t.lookahead)==null?void 0:d.type)==="Async"&&!s&&(t.eat("Async"),o=!0),a||t.eat("Function"),((b=t.lookahead)==null?void 0:b.type)==="*"&&(t.eat("*"),c=!0),t.eat("(");const l=[];for(;((f=t.lookahead)==null?void 0:f.type)!==")";)l.length>0&&t.eat(","),l.push(new h(t));t.eat(")");const u=new y(t);this.id=null,this.expression=!1,this.generator=c,this.async=o,this.params=l,this.body=u}}class F{constructor(t,a,s,o,c,l){e(this,"type","MethodDefinition");e(this,"static");e(this,"computed");e(this,"key");e(this,"kind");e(this,"value");this.static=a,this.computed=o,this.kind=l||"method",this.key=c,this.value=new I(t,!0,s)}}class P{constructor(t){e(this,"type","BooleanLiteral");e(this,"value");e(this,"raw");e(this,"start");e(this,"end");const a=t.eat("Boolean");this.start=a.start,this.end=a.end;const s=a.value==="true";this.value=s,this.raw=String(s)}}class M{constructor(t){e(this,"type","NaNLiteral");e(this,"value");e(this,"raw");e(this,"start");e(this,"end");const a=t.eat("NaN");this.start=a.start,this.end=a.end,this.value=Number.NaN,this.raw="NaN"}}class V{constructor(t){e(this,"type","NullLiteral");e(this,"value");e(this,"raw");e(this,"start");e(this,"end");const a=t.eat("Null");this.start=a.start,this.end=a.end,this.value=null,this.raw="null"}}class G{constructor(t){e(this,"type","NumericLiteral");e(this,"value");e(this,"raw");e(this,"start");e(this,"end");const a=t.eat("Number");this.start=a.start,this.end=a.end,this.value=Number(a.value),this.raw=String(a.value)}}class Y{constructor(t){e(this,"type","StringLiteral");e(this,"value");e(this,"raw");e(this,"start");e(this,"end");const a=t.eat("String");this.start=a.start,this.end=a.end;const s=String(a.value).slice(1,-1);this.value=s,this.raw=JSON.stringify(s)}}class H{constructor(t){e(this,"type","UndefinedLiteral");e(this,"value");e(this,"raw");e(this,"start");e(this,"end");const a=t.eat("Undefined");this.start=a.start,this.end=a.end,this.value=void 0,this.raw="undefined"}}class O{constructor(t){e(this,"type","Literal");e(this,"value");e(this,"raw");var s;let a;switch((s=t.lookahead)==null?void 0:s.type){case"Number":{a=new G(t);break}case"String":{a=new Y(t);break}case"Boolean":{a=new P(t);break}case"NaN":{a=new M(t);break}case"Null":{a=new V(t);break}case"Undefined":{a=new H(t);break}}this.value=a.value,this.raw=a.raw}}class z{constructor(t){e(this,"type","DoWhileStatement");e(this,"body");e(this,"test");t.eat("Do"),this.body=new y(t),t.eat("While"),t.eat("("),this.test=new E(t),t.eat(")")}}class ${constructor(t){e(this,"type","BreakStatement");e(this,"label");var s;t.eat("Break");let a=null;((s=t.lookahead)==null?void 0:s.type)==="Identifier"&&(a=new h(t).name),this.label=a}}class q{constructor(t){e(this,"type","ContinueStatement");e(this,"label");var s;t.eat("Break");let a=null;((s=t.lookahead)==null?void 0:s.type)==="Identifier"&&(a=new h(t).name),this.label=a}}class X{constructor(t){e(this,"type","ReturnStatement");e(this,"argument");t.eat("Return");const a=new E(t);this.argument=a}}class J{constructor(t){e(this,"type","ThrowStatement");e(this,"argument");t.eat("Throw");const a=new E(t);this.argument=a}}class Z{constructor(t){e(this,"type","DebuggerStatement");t.eat("Debugger")}}class _{constructor(t){e(this,"type","SwitchStatement");e(this,"discriminant");e(this,"cases",[]);var a,s,o,c,l,u;for(t.eat("Switch"),t.eat("("),this.discriminant=new E(t),t.eat(")"),t.eat("{");((a=t.lookahead)==null?void 0:a.type)!=="Default"&&((s=t.lookahead)==null?void 0:s.type)!=="}";){let d=!1;t.eat("Case");const b=new E(t);for(t.eat(":");((o=t.lookahead)==null?void 0:o.type)!=="Case"&&((c=t.lookahead)==null?void 0:c.type)!=="Default"&&((l=t.lookahead)==null?void 0:l.type)!=="}";)this.cases.push({type:"SwitchCase",test:b,consequent:new D(t,["Case","Default","}"]).body}),d=!0;d||this.cases.push({type:"SwitchCase",test:b,consequent:[]})}((u=t.lookahead)==null?void 0:u.type)==="Default"&&(t.eat("Default"),t.eat(":"),this.cases.push({type:"SwitchCase",test:null,consequent:new D(t).body})),t.eat("}")}}class Q{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case"Do":case"While":case"For":{Object.assign(this,new x(t));break}case"Switch":{Object.assign(this,new _(t));break}}}}class N{constructor(t){e(this,"type","IfStatement");e(this,"test");e(this,"consequent");e(this,"alternate");var a,s,o,c,l;t.eat("If"),t.eat("("),this.test=((a=t.lookahead)==null?void 0:a.type)==="Identifier"?new h(t):new E(t),t.eat(")"),this.consequent=((s=t.lookahead)==null?void 0:s.type)==="{"?new y(t):new C(t),((o=t.lookahead)==null?void 0:o.type)==="Else"&&(t.eat("Else"),((c=t.lookahead)==null?void 0:c.type)==="If"?this.alternate=new N(t):this.alternate=((l=t.lookahead)==null?void 0:l.type)==="{"?new y(t):new C(t))}}class K{constructor(t){e(this,"type","CatchClause");e(this,"body");e(this,"param",null);var a;t.eat("Catch"),((a=t.lookahead)==null?void 0:a.type)==="("&&(t.eat("("),this.param=new h(t),t.eat(")")),this.body=new y(t)}}class tt{constructor(t){e(this,"type","TryStatement");e(this,"block");e(this,"handler",null);e(this,"finalizer",null);var a,s,o,c;if(t.eat("Try"),this.block=new y(t),((a=t.lookahead)==null?void 0:a.type)!=="Catch"&&((s=t.lookahead)==null?void 0:s.type)!=="Finally")throw new Error("Expected Catch or Finally");((o=t.lookahead)==null?void 0:o.type)==="Catch"&&(this.handler=new K(t)),((c=t.lookahead)==null?void 0:c.type)==="Finally"&&(t.eat("Finally"),this.finalizer=new y(t))}}class et{constructor(t){e(this,"type","WithStatement");t.eat("With")}}class at{constructor(t){e(this,"expression");this.expression=new E(t)}}class C{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case"{":{Object.assign(this,new y(t));break}case"If":{Object.assign(this,new N(t));break}case"Do":case"While":case"For":case"Switch":{Object.assign(this,new Q(t));break}case"Continue":{Object.assign(this,new q(t));break}case"Break":{Object.assign(this,new $(t));break}case"Return":{Object.assign(this,new X(t));break}case"With":{Object.assign(this,new et(t));break}case"Throw":{Object.assign(this,new J(t));break}case"Try":{Object.assign(this,new tt(t));break}case"Debugger":{Object.assign(this,new Z(t));break}default:{Object.assign(this,new at(t));break}}}}class nt{constructor(t){e(this,"type","WhileStatement");e(this,"body");e(this,"test");var a;t.eat("While"),t.eat("("),this.test=new E(t),t.eat(")"),this.body=((a=t.lookahead)==null?void 0:a.type)==="{"?new y(t):new C(t)}}class st{constructor(t,a=!1){e(this,"type","VariableDeclarator");e(this,"id");e(this,"init",{type:"Literal",raw:"undefined"});var o;const s=new h(t);(a||((o=t.lookahead)==null?void 0:o.type)==="=")&&(t.eat("="),this.init=new E(t)),this.id=s}}class r{constructor(t){e(this,"type","VariableDeclaration");e(this,"declarations");e(this,"kind");var c,l,u;let a="var",s=!1;switch((c=t.lookahead)==null?void 0:c.type){case"Var":{t.eat("Var"),a="var";break}case"Let":{t.eat("Let"),a="let";break}case"Const":{t.eat("Const"),a="const",s=!0;break}default:throw new SyntaxError(`Unexpected token: "${(l=t.lookahead)==null?void 0:l.value}", expected a variable declarator!`)}const o=[];do o.push(new st(t,s));while(((u=t.lookahead)==null?void 0:u.type)===","&&t.eat(","));this.declarations=o,this.kind=a}}class it{constructor(t){e(this,"type","ForStatement");e(this,"init");e(this,"test");e(this,"update");e(this,"body");var s,o,c,l,u,d,b;t.eat("For");let a=!1;if(((s=t.lookahead)==null?void 0:s.type)==="Await"&&(t.eat("Await"),a=!0),t.eat("("),!a&&((o=t.lookahead)==null?void 0:o.type)!=="In"&&((c=t.lookahead)==null?void 0:c.type)!=="Of"){switch((l=t.lookahead)==null?void 0:l.type){case"Let":case"Var":{this.init=new r(t);break}case"Const":throw new Error("Const declarations are not allowed in for loops");default:{this.init=new h(t);break}}t.eat(";"),this.test=new E(t),((u=t.lookahead)==null?void 0:u.type)===";"&&t.eat(";"),((d=t.lookahead)==null?void 0:d.type)!==")"&&(this.update=new E(t))}else throw new Error("For loop with in or of is not implemented");t.eat(")"),this.body=((b=t.lookahead)==null?void 0:b.type)==="{"?new y(t):new C(t)}}class x{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case"Do":{Object.assign(this,new z(t));break}case"While":{Object.assign(this,new nt(t));break}case"For":{Object.assign(this,new it(t));break}}}}class ot{constructor(t,a){e(this,"type","LabelledStatement");e(this,"label");e(this,"body");this.label=a,t.eat(":"),this.body=new x(t)}}class ct{constructor(t){e(this,"type","ArrayExpression");e(this,"elements");var s,o;const a=[];for(t.eat("[");((s=t.lookahead)==null?void 0:s.type)!=="]";)a.push(new O(t).value),((o=t.lookahead)==null?void 0:o.type)!=="]"&&t.eat(",");t.eat("]"),this.elements=a}}class lt{constructor(t,a){e(this,"type","BinaryExpression");e(this,"left");e(this,"operator");e(this,"right");var s,o,c,l;switch(this.left=a??(((s=t.lookahead)==null?void 0:s.type)==="Identifier"?new h(t):new E(t)),(o=t.lookahead)==null?void 0:o.type){case"+":case"-":case"*":case"/":case"%":case"**":case"^":case">":case">>":case">>>":case"<":case"<<":case"<<<":case">=":case"<=":case"==":case"===":{this.operator=String(t.eat(String((c=t.lookahead)==null?void 0:c.type)).value);break}default:throw new Error("Invalid operator for BinaryExpression")}this.right=((l=t.lookahead)==null?void 0:l.type)==="Identifier"?new h(t):new E(t)}}class B{constructor(t,a){e(this,"type","AssignmentExpression");e(this,"left");e(this,"operator");e(this,"right");var s,o;this.left=a??(((s=t.lookahead)==null?void 0:s.type)==="Identifier"?new h(t):new E(t)),this.operator=String(t.eat("=").value),this.right=((o=t.lookahead)==null?void 0:o.type)==="Identifier"?new h(t):new E(t)}}class ut{constructor(t){e(this,"type","UpdateExpression");e(this,"operator");e(this,"argument");e(this,"prefix");var a,s,o;((a=t.lookahead)==null?void 0:a.type)==="++"||((s=t.lookahead)==null?void 0:s.type)==="--"?(this.prefix=!0,this.operator=String(t.eat(t.lookahead.type).value),this.argument=new h(t)):((o=t.lookahead)==null?void 0:o.type)==="Identifier"&&(this.argument=new h(t),this.prefix=!1,this.operator=String(t.eat(t.lookahead.type).value))}}class ht{constructor(t){e(this,"type","UnaryExpression");e(this,"operator");e(this,"prefix");e(this,"argument");var a,s;switch((a=t.lookahead)==null?void 0:a.type){case"delete":case"void":case"typeof":case"+":case"-":case"~":case"!":{this.operator=String(t.eat(String((s=t.lookahead)==null?void 0:s.type)).value),this.prefix=!0,this.argument=new E(t);break}}}}class Et{constructor(t,a){e(this,"type","LogicalExpression");e(this,"left");e(this,"operator");e(this,"right");var s,o,c,l;switch(this.left=a??(((s=t.lookahead)==null?void 0:s.type)==="Identifier"?new h(t):new E(t)),(o=t.lookahead)==null?void 0:o.type){case"??":case"||":case"&&":{this.operator=String(t.eat(String((c=t.lookahead)==null?void 0:c.type)).value);break}default:throw new Error("Invalid operator for LogicalExpression")}this.right=((l=t.lookahead)==null?void 0:l.type)==="Identifier"?new h(t):new E(t)}}class bt{constructor(t){e(this,"type","AwaitExpression");e(this,"argument");t.eat("Await"),this.argument=new E(t)}}class dt{constructor(t){e(this,"type","ThisExpression");t.eat("This")}}class v{constructor(t,a){e(this,"type","MemberExpression");e(this,"object");e(this,"property",null);e(this,"computed",!1);e(this,"optional",!1);var s,o,c;this.object=a;do switch((s=t.lookahead)==null?void 0:s.type){case"[":{t.eat("["),this.object=this.property?{...this}:{...this.object},this.property=new E(t),t.eat("]"),this.computed=!0;break}case".":{t.eat("."),this.object=this.property?{...this}:{...this.object},this.property=new h(t),this.computed=!1;break}}while(((o=t.lookahead)==null?void 0:o.type)==="."||((c=t.lookahead)==null?void 0:c.type)==="[")}}class kt{constructor(t){e(this,"type","ObjectExpression");e(this,"body",[]);var a,s,o,c,l,u,d;for(t.eat("{");((a=t.lookahead)==null?void 0:a.type)!=="}";){const b=((s=t.lookahead)==null?void 0:s.type)==="Get";b&&t.eat("Get");const f=((o=t.lookahead)==null?void 0:o.type)==="Set";f&&t.eat("Set");let w=!1,S=!1,g=null;!b&&!f&&(S=((c=t.lookahead)==null?void 0:c.type)==="Async",S&&t.eat("Async"),w=((l=t.lookahead)==null?void 0:l.type)==="[",w&&(t.eat("["),g=new h(t),t.eat("]"))),g===null&&(g=new h(t)),((u=t.lookahead)==null?void 0:u.type)==="("?this.body.push(new F(t,!1,S,w,g,b?"get":f?"set":"method")):this.body.push(new L(t,!1,w,g,":")),((d=t.lookahead)==null?void 0:d.type)!=="}"&&t.eat(",")}t.eat("}")}}class ft{constructor(t,a){e(this,"type","CallExpression");e(this,"callee");e(this,"arguments",[]);e(this,"optional",!1);var s;for(this.callee=a,t.eat("(");((s=t.lookahead)==null?void 0:s.type)!==")";)this.arguments.length>0&&t.eat(","),this.arguments.push(new E(t));t.eat(")")}}class E{constructor(t){var a,s,o,c;switch((a=t.lookahead)==null?void 0:a.type){case"Async":case"Function":{Object.assign(this,new I(t));break}case"[":{Object.assign(this,new ct(t));break}case"{":{Object.assign(this,new kt(t));break}case"Number":case"String":case"Boolean":case"NaN":case"Null":case"Undefined":{Object.assign(this,new O(t));break}case"++":case"--":{Object.assign(this,new ut(t));break}case"delete":case"void":case"typeof":case"+":case"-":case"~":case"!":{Object.assign(this,new ht(t));break}case"Await":{Object.assign(this,new bt(t));break}case"This":{Object.assign(this,new dt(t)),((s=t.lookahead)==null?void 0:s.type)==="."&&Object.assign(this,new v(t,this));break}case"Identifier":{const l=new h(t);switch((o=t.lookahead)==null?void 0:o.type){case"+":case"-":case"*":case"/":case"%":case"**":case"^":case">":case">>":case">>>":case"<":case"<<":case"<<<":case">=":case"<=":case"==":case"===":{Object.assign(this,new lt(t,l));break}case"=":{Object.assign(this,new B(t,l));break}case"??":case"||":case"&&":{Object.assign(this,new Et(t,l));break}case":":{Object.assign(this,new ot(t,l));break}case"[":case".":{const u=new v(t,l);switch((c=t.lookahead)==null?void 0:c.type){case"=":{Object.assign(this,new B(t,u));break}case"(":{Object.assign(this,new ft(t,u));break}default:{Object.assign(this,u);break}}break}default:{Object.assign(this,l);break}}break}}}}class L{constructor(t,a,s,o,c="="){e(this,"type","PropertyDefinition");e(this,"static");e(this,"computed");e(this,"key");e(this,"value");var l;this.static=a,this.computed=s,this.key=o,((l=t.lookahead)==null?void 0:l.type)===c?(t.eat(c),this.value=new E(t)):this.value=null}}class yt{constructor(t){e(this,"type","ClassBody");e(this,"body",[]);var a,s,o,c,l,u,d;for(t.eat("{");((a=t.lookahead)==null?void 0:a.type)!=="}";){const b=((s=t.lookahead)==null?void 0:s.type)==="Get";b&&t.eat("Get");const f=((o=t.lookahead)==null?void 0:o.type)==="Set";f&&t.eat("Set");let w=!1,S=!1,g=!1,A=null;!b&&!f&&(w=((c=t.lookahead)==null?void 0:c.type)==="Static",w&&t.eat("Static"),g=((l=t.lookahead)==null?void 0:l.type)==="Async",g&&t.eat("Async"),S=((u=t.lookahead)==null?void 0:u.type)==="[",S&&(t.eat("["),A=new h(t),t.eat("]"))),A===null&&(A=new h(t)),((d=t.lookahead)==null?void 0:d.type)==="("?this.body.push(new F(t,w,g,S,A,b?"get":f?"set":"method")):this.body.push(new L(t,w,S,A))}t.eat("}")}}class wt{constructor(t){e(this,"type","ClassDeclaration");e(this,"id");e(this,"superClass",null);e(this,"body");var a;t.eat("Class"),this.id=new h(t),((a=t.lookahead)==null?void 0:a.type)==="("&&(t.eat("("),this.superClass=new h(t),t.eat(")")),this.body=new yt(t)}}class gt{constructor(t){e(this,"type","FunctionDeclaration");e(this,"id");e(this,"expression");e(this,"generator");e(this,"async");e(this,"params");e(this,"body");var u,d,b,f;let a=!1,s=!1;((u=t.lookahead)==null?void 0:u.type)==="Async"&&(t.eat("Async"),a=!0),t.eat("Function"),((d=t.lookahead)==null?void 0:d.type)==="*"&&(t.eat("*"),s=!0);const o=String(new h(t).name);t.eat("(");const c=[];for(;((b=t.lookahead)==null?void 0:b.type)!==")";)c.push(new h(t)),((f=t.lookahead)==null?void 0:f.type)!==")"&&t.eat(",");t.eat(")");const l=new y(t);this.id={type:"Identifier",name:o},this.expression=!1,this.generator=s,this.async=a,this.params=c,this.body=l}}class mt{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case"Var":case"Let":case"Const":{Object.assign(this,new r(t));break}case"Async":case"Function":{Object.assign(this,new gt(t));break}case"Class":{Object.assign(this,new wt(t));break}}}}class St{constructor(t){var a;switch((a=t.lookahead)==null?void 0:a.type){case"Var":case"Let":case"Const":case"Async":case"Function":case"Class":{Object.assign(this,new mt(t));break}case"If":case"Do":case"While":case"For":case"Switch":case"Continue":case"Break":case"Return":case"With":case"Identifier":case"Throw":case"Try":case"Debugger":{Object.assign(this,new C(t));break}}}}class D{constructor(t,a){e(this,"body");var o,c,l;const s=[];for(;t.tokenizer.isEOF()===!1&&!(a!=null&&a.includes(String((o=t.lookahead)==null?void 0:o.type)));){const u=new St(t);for(u!==void 0&&s.push(u),((c=t.lookahead)==null?void 0:c.type)===";"&&t.eat(";");((l=t.lookahead)==null?void 0:l.type)===";";)s.push(new W(t))}this.body=s}}class Ct{constructor(t){e(this,"type","Program");e(this,"body");this.body=new D(t).body}}class R{constructor(){e(this,"syntax");e(this,"tokenizer");e(this,"lookahead");this.syntax="",this.tokenizer=new T(this),this.lookahead=null}parse(t){return this.lookahead=null,this.syntax="",this.syntax=t,this.tokenizer=new T(this),this.lookahead=this.tokenizer.getNextToken(),new Ct(this)}eat(t){const a=this.lookahead;if(a===null)throw new SyntaxError(`Unexpected end of input, expected: "${t}"`);if(a.type!==t)switch(t){case i.IDENTIFIER:throw new SyntaxError(`Unexpected token: "${a.value}", cannot use keyword "${a.value}" for the beginning of the identifer`);default:throw new SyntaxError(`Unexpected token: "${a.value}", expected: "${t}"`)}return this.lookahead=this.tokenizer.getNextToken(t==="Identifier"),a}}const j=new R;typeof window<"u"&&(customElements.define("vi-script",class extends HTMLElement{constructor(){super()}connectedCallback(){setTimeout(()=>{var n;(n=this.childNodes.item(0).textContent)==null||n.trim(),this.innerHTML=""})}}),window.VietScript={parser:j}),k.Parser=R,k.Tokenizer=T,k.default=j,Object.defineProperties(k,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
