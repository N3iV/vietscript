(function(a,e){typeof exports=="object"&&typeof module<"u"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(a=typeof globalThis<"u"?globalThis:a||self,e(a.vietscript={}))})(this,function(exports){"use strict";var w=Object.defineProperty;var f=(a,e,n)=>e in a?w(a,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[e]=n;var t=(a,e,n)=>(f(a,typeof e!="symbol"?e+"":e,n),n);var Keyword=(a=>(a.VAR="Var",a.CONST="Const",a.LET="Let",a.IF="If",a.ELSE="Else",a.FOR="For",a.WHILE="While",a.DO="Do",a.BREAK="Break",a.CONTINUE="Continue",a.RETURN="Return",a.SWITCH="Switch",a.CASE="Case",a.DEFAULT="Default",a.TRY="Try",a.CATCH="Catch",a.FINALLY="Finally",a.THROW="Throw",a.FUNCTION="Function",a.CLASS="Class",a.INTERFACE="Interface",a.ENUM="Enum",a.TYPE="Type",a.IMPORT="Import",a.EXPORT="Export",a.FROM="From",a.AS="As",a.IN="In",a.OF="Of",a.IS="Is",a.NEW="New",a.THIS="This",a.SUPER="Super",a.TRUE="True",a.FALSE="False",a.NULL="Null",a.VOID="Void",a.ANY="Any",a.NUMBER="Number",a.STRING="String",a.BOOLEAN="Boolean",a.OBJECT="Object",a.ARRAY="Array",a.NAN="NaN",a.INFINITY="Infinity",a.UNDEFINED="Undefined",a.STATIC="Static",a.PUBLIC="Public",a.PRIVATE="Private",a.PROTECTED="Protected",a.ABSTRACT="Abstract",a.EXTENDS="Extends",a.IMPLEMENTS="Implements",a.GET="Get",a.SET="Set",a.CONSTRUCTOR="Constructor",a.YIELD="Yield",a.AWAIT="Await",a.ASYNC="Async",a.DELETE="Delete",a.TYPEOF="Typeof",a.INSTANCEOF="Instanceof",a.WITH="With",a.DEBUGGER="Debugger",a.IDENTIFIER="Identifier",a))(Keyword||{});const vietnameseUnicodeSet="\\u00C0\\u00C1\\u00C2\\u00C3\\u00C8\\u00C9\\u00CA\\u00CC\\u00CD\\u00D2\\u00D3\\u00D4\\u00D5\\u00D9\\u00DA\\u0102\\u0110\\u0128\\u0168\\u01A0\\u00E0\\u00E1\\u00E2\\u00E3\\u00E8\\u00E9\\u00EA\\u00EC\\u00ED\\u00F2\\u00F3\\u00F4\\u00F5\\u00F9\\u00FA\\u0103\\u0111\\u0129\\u0169\\u01A1\\u01AF\\u0102\\u1EA0\\u1EA2\\u1EA4\\u1EA6\\u1EA8\\u1EAA\\u1EAC\\u1EAE\\u1EB0\\u1EB2\\u1EB4\\u1EB6\\u1EB8\\u1EBA\\u1EBC\\u1EC0{2}\\u1EC2\\u01B0\\u0103\\u1EA1\\u1EA3\\u1EA5\\u1EA7\\u1EA9\\u1EAB\\u1EAD\\u1EAF\\u1EB1\\u1EB3\\u1EB5\\u1EB7\\u1EB9\\u1EBB\\u1EBD\\u1EC1{2}\\u1EC3\\u1EC4\\u1EC6\\u1EC8\\u1ECA\\u1ECC\\u1ECE\\u1ED0\\u1ED2\\u1ED4\\u1ED6\\u1ED8\\u1EDA\\u1EDC\\u1EDE\\u1EE0\\u1EE2\\u1EE4\\u1EE6\\u1EE8\\u1EEA\\u1EC5\\u1EC7\\u1EC9\\u1ECB\\u1ECD\\u1ECF\\u1ED1\\u1ED3\\u1ED5\\u1ED7\\u1ED9\\u1EDB\\u1EDD\\u1EDF\\u1EE1\\u1EE3\\u1EE5\\u1EE7\\u1EE9\\u1EEB\\u1EEC\\u1EEE\\u1EF0\\u1EF2\\u1EF4\\u00DD\\u1EF6\\u1EF8\\u1EED\\u1EEF\\u1EF1\\u1EF3\\u1EF5\\u1EF7\\u1EF9",Specs=[[/^\s+/,null],[/^\/\/.*/,null],[/^\/\*[\S\s]*?\*\//,null],[/^\[/,"["],[/^]/,"]"],[/^\(/,"("],[/^\)/,")"],[/^{/,"{"],[/^}/,"}"],[/^;/,";"],[/^,/,","],[/^===/,"==="],[/^==/,"=="],[/^!==/,"!=="],[/^!=/,"!="],[/^=/,"="],[/^\?/,"?"],[/^\?\.?/,"?."],[/^:/,":"],[/^\.{3}/,"..."],[/^\./,"."],[/^\+\+/,"++"],[/^\+/,"+"],[/^--/,"--"],[/^-/,"-"],[/^~/,"~"],[/^!/,"!"],[/^\*/,"*"],[/^\//,"/"],[/^%/,"%"],[/^\*\*/,"**"],[/^\?\?/,"??"],[/^#/,"#"],[/^>>>=/,">>>="],[/^>>>/,">>>"],[/^>>/,">>"],[/^>>=/,">>="],[/^<<=/,"<<="],[/^<</,"<<"],[/^<=/,"<="],[/^>=/,">="],[/^</,"<"],[/^>/,">"],[/^&&/,"&&"],[/^\|\|/,"||"],[/^&/,"&"],[/^\^/,"^"],[/^\|/,"|"],[/^\*=/,"*="],[/^\//,"/="],[/^%=/,"%="],[/^\+=/,"+="],[/^-=/,"-="],[/^&=/,"&="],[/^\^=/,"^="],[/^\|=/,"|="],[/^\*\*=/,"**="],[/^=>/,"=>"],[/^\b(var|khai b\u00E1o)\b/,Keyword.VAR],[/^\b(break|ph\u00E1 v\u00F2ng l\u1EB7p)\b/,Keyword.BREAK],[/^\b(do|th\u1EF1c hi\u1EC7n)\b/,Keyword.DO],[/^\binstanceof\b/,Keyword.INSTANCEOF],[/^\b(typeof|ki\u1EC3u c\u1EE7a)\b/,Keyword.TYPEOF],[/^\b(switch|duy\u1EC7t)\b/,Keyword.SWITCH],[/^\b(case|tr\u01B0\u1EDDng h\u1EE3p)\b/,Keyword.CASE],[/^\b(if|n\u1EBFu)\b/,Keyword.IF],[/^\b(else|kh\u00F4ng th\u00EC)/,Keyword.ELSE],[/^\bnew\b/,Keyword.NEW],[/^\b(catch|b\u1EAFt l\u1ED7i)\b/,Keyword.CATCH],[/^\b(finally|cu\u1ED1i c\u00F9ng)\b/,Keyword.FINALLY],[/^\b(return|tr\u1EA3 v\u1EC1)/,Keyword.RETURN],[/^\bvoid\b/,Keyword.VOID],[/^\b(continue|ti\u1EBFp t\u1EE5c)\b/,Keyword.CONTINUE],[/^\bfor\b/,Keyword.FOR],[/^\b(while|khi m\u00E0)\b/,Keyword.WHILE],[/^\bdebugger\b/,Keyword.DEBUGGER],[/^\b(function|h\u00E0m)\b/,Keyword.FUNCTION],[/^\bthis\b/,Keyword.THIS],[/^\bwith\b/,Keyword.WITH],[/^\b(default|m\u1EB7c \u0111\u1ECBnh)\b/,Keyword.DEFAULT],[/^\b(throw|b\u00E1o l\u1ED7i)\b/,Keyword.THROW],[/^\b(delete|xo\u00E1)\b/,Keyword.DELETE],[/^\b(in|trong)\b/,Keyword.IN],[/^\b(try|th\u1EED)/,Keyword.TRY],[/^\bas\b/,Keyword.AS],[/^\b(from|t\u1EEB)\b/,Keyword.FROM],[/^const|h\u1EB1ng s\u1ED1/,Keyword.CONST],[/^\b(class|l\u1EDBp)\b/,Keyword.CLASS],[/^\b(super|kh\u1EDFi t\u1EA1o cha)\b/,Keyword.SUPER],[/^\b(constructor|kh\u1EDFi t\u1EA1o)\b/,Keyword.CONSTRUCTOR],[/^\benum\b/,Keyword.ENUM],[/^\b(extends|k\u1EBF th\u1EEBa)\b/,Keyword.EXTENDS],[/^\b(export|xu\u1EA5t)\b/,Keyword.EXPORT],[/^\b(import|nh\u1EADp)\b/,Keyword.IMPORT],[/^\b(async|b\u1EA5t \u0111\u1ED3ng b\u1ED9)/,Keyword.ASYNC],[/^\b(await|ch\u1EDD)\b/,Keyword.AWAIT],[/^\byield\b/,Keyword.YIELD],[/^\bimplements\b/,Keyword.IMPLEMENTS],[/^\blet\b/,Keyword.LET],[/^\bprivate\b/,Keyword.PRIVATE],[/^\bpublic\b/,Keyword.PUBLIC],[/^\binterface\b/,Keyword.INTERFACE],[/^\bprotected\b/,Keyword.PROTECTED],[/^\bstatic\b/,Keyword.STATIC],[/^(\d+(\.|)(\d+|)([Ee]([+-]|)\d+|))/,Keyword.NUMBER],[/^"[^"]*"/,Keyword.STRING],[/^'[^']*'/,Keyword.STRING],[/^`[^`]*`/,Keyword.STRING],[/^\bnull\b/,Keyword.NULL],[/^\bNaN\b/,Keyword.NAN],[/^\b(undefined|kh\u00F4ng x\u00E1c \u0111\u1ECBnh)\b/,Keyword.UNDEFINED],[/^\b(true|false)\b/,Keyword.BOOLEAN],[new RegExp(`^[a-zA-Z${vietnameseUnicodeSet}]+(\\s[a-zA-Z${vietnameseUnicodeSet}]+)*`),Keyword.IDENTIFIER]];class Tokenizer{constructor(e){t(this,"syntax");t(this,"cursor");t(this,"executable","");this.syntax=e,this.cursor=0}isEOF(){return this.cursor===this.syntax.length}hasMoreTokens(){return this.cursor<this.syntax.length}getNextToken(){if(!this.hasMoreTokens())return null;const e=this.syntax.slice(this.cursor);for(const[n,i]of Specs){const s=this.match(n,e);if(s===null)continue;if(i===null)return this.executable+=s,this.getNextToken();let o=s;switch(i){case Keyword.IDENTIFIER:{o=String(s).replace(/\s/g,"_").replace(/[^\dA-Za-z]/g,c=>encodeURI(c).replace(/%/g,""));break}case Keyword.NAN:case Keyword.NULL:case Keyword.UNDEFINED:case Keyword.BOOLEAN:case Keyword.STRING:case Keyword.NUMBER:{o=String(s);break}default:{o=(i||"").toLowerCase();break}}return this.executable+=o,{type:i,value:s,start:this.cursor-String(s).length,end:this.cursor}}throw new SyntaxError(`Unexpected token: "${e[0]}"`)}match(e,n){const i=e.exec(n);return i===null?null:(this.cursor+=i[0].length,i[0])}}class EmptyStatement{constructor(e){t(this,"type","EmptyStatement");e.eat(";")}}class Identifier{constructor(e){t(this,"type","Identifier");t(this,"name");this.name=String(e.eat("Identifier").value)}}class BlockStatement{constructor(e){t(this,"type","BlockStatement");t(this,"body");const n=[];e.eat("{"),n.push(...new StatementList(e,["}"]).body),e.eat("}"),this.body=n}}class FunctionExpression{constructor(e,n=!1,i=!1){t(this,"type","FunctionExpression");t(this,"id");t(this,"expression");t(this,"generator");t(this,"async");t(this,"params");t(this,"body");var h,u,E;let s=i,o=!1;((h=e.lookahead)==null?void 0:h.type)==="Async"&&!i&&(e.eat("Async"),s=!0),n||e.eat("Function"),((u=e.lookahead)==null?void 0:u.type)==="*"&&(e.eat("*"),o=!0),e.eat("(");const c=[];for(;((E=e.lookahead)==null?void 0:E.type)!==")";)c.length>0&&e.eat(","),c.push(new Identifier(e));e.eat(")");const l=new BlockStatement(e);this.id=null,this.expression=!1,this.generator=o,this.async=s,this.params=c,this.body=l}}class MethodDefinition{constructor(e,n,i,s,o,c){t(this,"type","MethodDefinition");t(this,"static");t(this,"computed");t(this,"key");t(this,"kind");t(this,"value");this.static=n,this.computed=s,this.kind=c||"method",this.key=o,this.value=new FunctionExpression(e,!0,i)}}class BooleanLiteral{constructor(e){t(this,"type","BooleanLiteral");t(this,"value");t(this,"raw");t(this,"start");t(this,"end");const n=e.eat("Boolean");this.start=n.start,this.end=n.end;const i=n.value==="true";this.value=i,this.raw=String(i)}}class NaNLiteral{constructor(e){t(this,"type","NaNLiteral");t(this,"value");t(this,"raw");t(this,"start");t(this,"end");const n=e.eat("NaN");this.start=n.start,this.end=n.end,this.value=Number.NaN,this.raw="NaN"}}class NullLiteral{constructor(e){t(this,"type","NullLiteral");t(this,"value");t(this,"raw");t(this,"start");t(this,"end");const n=e.eat("Null");this.start=n.start,this.end=n.end,this.value=null,this.raw="null"}}class NumericLiteral{constructor(e){t(this,"type","NumericLiteral");t(this,"value");t(this,"raw");t(this,"start");t(this,"end");const n=e.eat("Number");this.start=n.start,this.end=n.end,this.value=Number(n.value),this.raw=String(n.value)}}class StringLiteral{constructor(e){t(this,"type","StringLiteral");t(this,"value");t(this,"raw");t(this,"start");t(this,"end");const n=e.eat("String");this.start=n.start,this.end=n.end;const i=String(n.value).slice(1,-1);this.value=i,this.raw=JSON.stringify(i)}}class UndefinedLiteral{constructor(e){t(this,"type","UndefinedLiteral");t(this,"value");t(this,"raw");t(this,"start");t(this,"end");const n=e.eat("Undefined");this.start=n.start,this.end=n.end,this.value=void 0,this.raw="undefined"}}class Literal{constructor(e){t(this,"type","Literal");t(this,"value");t(this,"raw");var i;let n;switch((i=e.lookahead)==null?void 0:i.type){case"Number":{n=new NumericLiteral(e);break}case"String":{n=new StringLiteral(e);break}case"Boolean":{n=new BooleanLiteral(e);break}case"NaN":{n=new NaNLiteral(e);break}case"Null":{n=new NullLiteral(e);break}case"Undefined":{n=new UndefinedLiteral(e);break}}this.value=n.value,this.raw=n.raw}}class DoWhileStatement{constructor(e){t(this,"type","DoWhileStatement");t(this,"body");t(this,"test");e.eat("Do"),this.body=new BlockStatement(e),e.eat("While"),e.eat("("),this.test=new Expression(e),e.eat(")")}}class BreakStatement{constructor(e){t(this,"type","BreakStatement");t(this,"label");var i;e.eat("Break");let n=null;((i=e.lookahead)==null?void 0:i.type)==="Identifier"&&(n=String(e.eat("Identifier").value)),this.label=n}}class ContinueStatement{constructor(e){t(this,"type","ContinueStatement");t(this,"label");var i;e.eat("Break");let n=null;((i=e.lookahead)==null?void 0:i.type)==="Identifier"&&(n=String(e.eat("Identifier").value)),this.label=n}}class ReturnStatement{constructor(e){t(this,"type","ReturnStatement");t(this,"argument");e.eat("Return");const n=new Expression(e);this.argument=n}}class ThrowStatement{constructor(e){t(this,"type","ThrowStatement");t(this,"argument");e.eat("Throw");const n=new Expression(e);this.argument=n}}class DebuggerStatement{constructor(e){t(this,"type","DebuggerStatement");e.eat("Debugger")}}class SwitchStatement{constructor(e){t(this,"type","SwitchStatement");t(this,"discriminant");t(this,"cases",[]);var n,i,s,o,c,l;for(e.eat("Switch"),e.eat("("),this.discriminant=new Expression(e),e.eat(")"),e.eat("{");((n=e.lookahead)==null?void 0:n.type)!=="Default"&&((i=e.lookahead)==null?void 0:i.type)!=="}";){let h=!1;e.eat("Case");const u=new Expression(e);for(e.eat(":");((s=e.lookahead)==null?void 0:s.type)!=="Case"&&((o=e.lookahead)==null?void 0:o.type)!=="Default"&&((c=e.lookahead)==null?void 0:c.type)!=="}";)this.cases.push({type:"SwitchCase",test:u,consequent:new StatementList(e,["Case","Default","}"]).body}),h=!0;h||this.cases.push({type:"SwitchCase",test:u,consequent:[]})}((l=e.lookahead)==null?void 0:l.type)==="Default"&&(e.eat("Default"),e.eat(":"),this.cases.push({type:"SwitchCase",test:null,consequent:new StatementList(e).body})),e.eat("}")}}class BreakableStatement{constructor(e){var n;switch((n=e.lookahead)==null?void 0:n.type){case"Do":case"While":case"For":{Object.assign(this,new IterationStatement(e));break}case"Switch":{Object.assign(this,new SwitchStatement(e));break}}}}class IfStatement{constructor(e){t(this,"type","IfStatement");t(this,"test");t(this,"consequent");t(this,"alternate");var n,i,s,o,c;e.eat("If"),e.eat("("),this.test=((n=e.lookahead)==null?void 0:n.type)==="Identifier"?new Identifier(e):new Expression(e),e.eat(")"),this.consequent=((i=e.lookahead)==null?void 0:i.type)==="{"?new BlockStatement(e):new Statement(e),((s=e.lookahead)==null?void 0:s.type)==="Else"&&(e.eat("Else"),((o=e.lookahead)==null?void 0:o.type)==="If"?this.alternate=new IfStatement(e):this.alternate=((c=e.lookahead)==null?void 0:c.type)==="{"?new BlockStatement(e):new Statement(e))}}class CatchClause{constructor(e){t(this,"type","CatchClause");t(this,"body");t(this,"param",null);var n;e.eat("Catch"),((n=e.lookahead)==null?void 0:n.type)==="("&&(e.eat("("),this.param=new Identifier(e),e.eat(")")),this.body=new BlockStatement(e)}}class TryStatement{constructor(e){t(this,"type","TryStatement");t(this,"block");t(this,"handler",null);t(this,"finalizer",null);var n,i,s,o;if(e.eat("Try"),this.block=new BlockStatement(e),((n=e.lookahead)==null?void 0:n.type)!=="Catch"&&((i=e.lookahead)==null?void 0:i.type)!=="Finally")throw new Error("Expected Catch or Finally");((s=e.lookahead)==null?void 0:s.type)==="Catch"&&(this.handler=new CatchClause(e)),((o=e.lookahead)==null?void 0:o.type)==="Finally"&&(e.eat("Finally"),this.finalizer=new BlockStatement(e))}}class WithStatement{constructor(e){t(this,"type","WithStatement");e.eat("With")}}class ExpressionStatement{constructor(e){t(this,"expression");this.expression=new Expression(e)}}class Statement{constructor(e){var n;switch((n=e.lookahead)==null?void 0:n.type){case"{":{Object.assign(this,new BlockStatement(e));break}case"If":{Object.assign(this,new IfStatement(e));break}case"Do":case"While":case"For":case"Switch":{Object.assign(this,new BreakableStatement(e));break}case"Continue":{Object.assign(this,new ContinueStatement(e));break}case"Break":{Object.assign(this,new BreakStatement(e));break}case"Return":{Object.assign(this,new ReturnStatement(e));break}case"With":{Object.assign(this,new WithStatement(e));break}case"Throw":{Object.assign(this,new ThrowStatement(e));break}case"Try":{Object.assign(this,new TryStatement(e));break}case"Debugger":{Object.assign(this,new DebuggerStatement(e));break}default:{Object.assign(this,new ExpressionStatement(e));break}}}}class WhileStatement{constructor(e){t(this,"type","WhileStatement");t(this,"body");t(this,"test");var n;e.eat("While"),e.eat("("),this.test=new Expression(e),e.eat(")"),this.body=((n=e.lookahead)==null?void 0:n.type)==="{"?new BlockStatement(e):new Statement(e)}}class VariableDeclarator{constructor(e,n=!1){t(this,"type","VariableDeclarator");t(this,"id");t(this,"init",{type:"Literal",raw:"undefined"});var s;const i=e.eat("Identifier");(n||((s=e.lookahead)==null?void 0:s.type)==="=")&&(e.eat("="),this.init=new Expression(e)),this.id={type:"Identifier",name:String(i.value)}}}class VariableDeclaration{constructor(e){t(this,"type","VariableDeclaration");t(this,"declarations");t(this,"kind");var o,c;let n="var",i=!1;switch((o=e.lookahead)==null?void 0:o.type){case"Var":{e.eat("Var"),n="var";break}case"Let":{e.eat("Let"),n="let";break}case"Const":{e.eat("Const"),n="const",i=!0;break}}const s=[];do s.push(new VariableDeclarator(e,i));while(((c=e.lookahead)==null?void 0:c.type)===","&&e.eat(","));this.declarations=s,this.kind=n}}class ForStatement{constructor(e){t(this,"type","ForStatement");t(this,"init");t(this,"test");t(this,"update");t(this,"body");var i,s,o,c,l,h,u;e.eat("For");let n=!1;if(((i=e.lookahead)==null?void 0:i.type)==="Await"&&(e.eat("Await"),n=!0),e.eat("("),!n&&((s=e.lookahead)==null?void 0:s.type)!=="In"&&((o=e.lookahead)==null?void 0:o.type)!=="Of"){switch((c=e.lookahead)==null?void 0:c.type){case"Let":case"Var":{this.init=new VariableDeclaration(e);break}case"Const":throw new Error("Const declarations are not allowed in for loops");default:{this.init=new Identifier(e);break}}e.eat(";"),this.test=new Expression(e),((l=e.lookahead)==null?void 0:l.type)===";"&&e.eat(";"),((h=e.lookahead)==null?void 0:h.type)!==")"&&(this.update=new Expression(e))}else throw new Error("For loop with in or of is not implemented");e.eat(")"),this.body=((u=e.lookahead)==null?void 0:u.type)==="{"?new BlockStatement(e):new Statement(e)}}class IterationStatement{constructor(e){var n;switch((n=e.lookahead)==null?void 0:n.type){case"Do":{Object.assign(this,new DoWhileStatement(e));break}case"While":{Object.assign(this,new WhileStatement(e));break}case"For":{Object.assign(this,new ForStatement(e));break}}}}class LabelledStatement{constructor(e,n){t(this,"type","LabelledStatement");t(this,"label");t(this,"body");this.label=n,e.eat(":"),this.body=new IterationStatement(e)}}class ArrayExpression{constructor(e){t(this,"type","ArrayExpression");t(this,"elements");var i,s;const n=[];for(e.eat("[");((i=e.lookahead)==null?void 0:i.type)!=="]";)n.push(new Literal(e).value),((s=e.lookahead)==null?void 0:s.type)!=="]"&&e.eat(",");e.eat("]"),this.elements=n}}class BinaryExpression{constructor(e,n){t(this,"type","BinaryExpression");t(this,"left");t(this,"operator");t(this,"right");var i,s,o,c;switch(this.left=n??(((i=e.lookahead)==null?void 0:i.type)==="Identifier"?new Identifier(e):new Expression(e)),(s=e.lookahead)==null?void 0:s.type){case"+":case"-":case"*":case"/":case"%":case"**":case"^":case">":case">>":case">>>":case"<":case"<<":case"<<<":case">=":case"<=":case"==":case"===":{this.operator=String(e.eat(String((o=e.lookahead)==null?void 0:o.type)).value);break}default:throw new Error("Invalid operator for BinaryExpression")}this.right=((c=e.lookahead)==null?void 0:c.type)==="Identifier"?new Identifier(e):new Expression(e)}}class AssignmentExpression{constructor(e,n){t(this,"type","AssignmentExpression");t(this,"left");t(this,"operator");t(this,"right");var i,s;this.left=n??(((i=e.lookahead)==null?void 0:i.type)==="Identifier"?new Identifier(e):new Expression(e)),this.operator=String(e.eat("=").value),this.right=((s=e.lookahead)==null?void 0:s.type)==="Identifier"?new Identifier(e):new Expression(e)}}class UpdateExpression{constructor(e){t(this,"type","UpdateExpression");t(this,"operator");t(this,"argument");t(this,"prefix");var n,i,s;((n=e.lookahead)==null?void 0:n.type)==="++"||((i=e.lookahead)==null?void 0:i.type)==="--"?(this.prefix=!0,this.operator=String(e.eat(e.lookahead.type).value),this.argument=new Identifier(e)):((s=e.lookahead)==null?void 0:s.type)==="Identifier"&&(this.argument=new Identifier(e),this.prefix=!1,this.operator=String(e.eat(e.lookahead.type).value))}}class UnaryExpression{constructor(e){t(this,"type","UnaryExpression");t(this,"operator");t(this,"prefix");t(this,"argument");var n,i;switch((n=e.lookahead)==null?void 0:n.type){case"delete":case"void":case"typeof":case"+":case"-":case"~":case"!":{this.operator=String(e.eat(String((i=e.lookahead)==null?void 0:i.type)).value),this.prefix=!0,this.argument=new Expression(e);break}}}}class LogicalExpression{constructor(e,n){t(this,"type","LogicalExpression");t(this,"left");t(this,"operator");t(this,"right");var i,s,o,c;switch(this.left=n??(((i=e.lookahead)==null?void 0:i.type)==="Identifier"?new Identifier(e):new Expression(e)),(s=e.lookahead)==null?void 0:s.type){case"??":case"||":case"&&":{this.operator=String(e.eat(String((o=e.lookahead)==null?void 0:o.type)).value);break}default:throw new Error("Invalid operator for LogicalExpression")}this.right=((c=e.lookahead)==null?void 0:c.type)==="Identifier"?new Identifier(e):new Expression(e)}}class AwaitExpression{constructor(e){t(this,"type","AwaitExpression");t(this,"argument");e.eat("Await"),this.argument=new Expression(e)}}class ThisExpression{constructor(e){t(this,"type","ThisExpression");e.eat("This")}}class MemberExpression{constructor(e,n){t(this,"type","MemberExpression");t(this,"object");t(this,"property",null);t(this,"computed",!1);t(this,"optional",!1);var i,s,o;this.object=n;do switch((i=e.lookahead)==null?void 0:i.type){case"[":{e.eat("["),this.object=this.property?{...this}:{...this.object},this.property=new Expression(e),e.eat("]"),this.computed=!0;break}case".":{e.eat("."),this.object=this.property?{...this}:{...this.object},this.property=new Identifier(e),this.computed=!1;break}}while(((s=e.lookahead)==null?void 0:s.type)==="."||((o=e.lookahead)==null?void 0:o.type)==="[")}}class ObjectExpression{constructor(e){t(this,"type","ObjectExpression");t(this,"body",[]);var n,i,s,o,c,l,h;for(e.eat("{");((n=e.lookahead)==null?void 0:n.type)!=="}";){const u=((i=e.lookahead)==null?void 0:i.type)==="Get";u&&e.eat("Get");const E=((s=e.lookahead)==null?void 0:s.type)==="Set";E&&e.eat("Set");let d=!1,r=!1,b=null;!u&&!E&&(r=((o=e.lookahead)==null?void 0:o.type)==="Async",r&&e.eat("Async"),d=((c=e.lookahead)==null?void 0:c.type)==="[",d&&(e.eat("["),b=new Identifier(e),e.eat("]"))),b===null&&(b=new Identifier(e)),((l=e.lookahead)==null?void 0:l.type)==="("?this.body.push(new MethodDefinition(e,!1,r,d,b,u?"get":E?"set":"method")):this.body.push(new PropertyDefinition(e,!1,d,b,":")),((h=e.lookahead)==null?void 0:h.type)!=="}"&&e.eat(",")}e.eat("}")}}class CallExpression{constructor(e,n){t(this,"type","CallExpression");t(this,"callee");t(this,"arguments",[]);t(this,"optional",!1);var i;for(this.callee=n,e.eat("(");((i=e.lookahead)==null?void 0:i.type)!==")";)this.arguments.length>0&&e.eat(","),this.arguments.push(new Expression(e));e.eat(")")}}class Expression{constructor(e){var n,i,s,o;switch((n=e.lookahead)==null?void 0:n.type){case"Async":case"Function":{Object.assign(this,new FunctionExpression(e));break}case"[":{Object.assign(this,new ArrayExpression(e));break}case"{":{Object.assign(this,new ObjectExpression(e));break}case"Number":case"String":case"Boolean":case"NaN":case"Null":case"Undefined":{Object.assign(this,new Literal(e));break}case"++":case"--":{Object.assign(this,new UpdateExpression(e));break}case"delete":case"void":case"typeof":case"+":case"-":case"~":case"!":{Object.assign(this,new UnaryExpression(e));break}case"Await":{Object.assign(this,new AwaitExpression(e));break}case"This":{Object.assign(this,new ThisExpression(e)),((i=e.lookahead)==null?void 0:i.type)==="."&&Object.assign(this,new MemberExpression(e,this));break}case"Identifier":{const c=new Identifier(e);switch((s=e.lookahead)==null?void 0:s.type){case"+":case"-":case"*":case"/":case"%":case"**":case"^":case">":case">>":case">>>":case"<":case"<<":case"<<<":case">=":case"<=":case"==":case"===":{Object.assign(this,new BinaryExpression(e,c));break}case"=":{Object.assign(this,new AssignmentExpression(e,c));break}case"??":case"||":case"&&":{Object.assign(this,new LogicalExpression(e,c));break}case":":{Object.assign(this,new LabelledStatement(e,c));break}case"[":case".":{const l=new MemberExpression(e,c);switch((o=e.lookahead)==null?void 0:o.type){case"=":{Object.assign(this,new AssignmentExpression(e,l));break}case"(":{Object.assign(this,new CallExpression(e,l));break}default:{Object.assign(this,l);break}}break}default:{Object.assign(this,c);break}}break}}}}class PropertyDefinition{constructor(e,n,i,s,o="="){t(this,"type","PropertyDefinition");t(this,"static");t(this,"computed");t(this,"key");t(this,"value");var c;this.static=n,this.computed=i,this.key=s,((c=e.lookahead)==null?void 0:c.type)===o?(e.eat(o),this.value=new Expression(e)):this.value=null}}class ClassBody{constructor(e){t(this,"type","ClassBody");t(this,"body",[]);var n,i,s,o,c,l,h;for(e.eat("{");((n=e.lookahead)==null?void 0:n.type)!=="}";){const u=((i=e.lookahead)==null?void 0:i.type)==="Get";u&&e.eat("Get");const E=((s=e.lookahead)==null?void 0:s.type)==="Set";E&&e.eat("Set");let d=!1,r=!1,b=!1,y=null;!u&&!E&&(d=((o=e.lookahead)==null?void 0:o.type)==="Static",d&&e.eat("Static"),b=((c=e.lookahead)==null?void 0:c.type)==="Async",b&&e.eat("Async"),r=((l=e.lookahead)==null?void 0:l.type)==="[",r&&(e.eat("["),y=new Identifier(e),e.eat("]"))),y===null&&(y=new Identifier(e)),((h=e.lookahead)==null?void 0:h.type)==="("?this.body.push(new MethodDefinition(e,d,b,r,y,u?"get":E?"set":"method")):this.body.push(new PropertyDefinition(e,d,r,y))}e.eat("}")}}class ClassDeclaration{constructor(e){t(this,"type","ClassDeclaration");t(this,"id");t(this,"superClass",null);t(this,"body");var n;e.eat("Class"),this.id=new Identifier(e),((n=e.lookahead)==null?void 0:n.type)==="("&&(e.eat("("),this.superClass=new Identifier(e),e.eat(")")),this.body=new ClassBody(e)}}class FunctionDeclaration{constructor(e){t(this,"type","FunctionDeclaration");t(this,"id");t(this,"expression");t(this,"generator");t(this,"async");t(this,"params");t(this,"body");var l,h,u,E;let n=!1,i=!1;((l=e.lookahead)==null?void 0:l.type)==="Async"&&(e.eat("Async"),n=!0),e.eat("Function"),((h=e.lookahead)==null?void 0:h.type)==="*"&&(e.eat("*"),i=!0);const s=String(e.eat("Identifier").value);e.eat("(");const o=[];for(;((u=e.lookahead)==null?void 0:u.type)!==")";)o.push(new Identifier(e)),((E=e.lookahead)==null?void 0:E.type)!==")"&&e.eat(",");e.eat(")");const c=new BlockStatement(e);this.id={type:"Identifier",name:s},this.expression=!1,this.generator=i,this.async=n,this.params=o,this.body=c}}class Declaration{constructor(e){var n;switch((n=e.lookahead)==null?void 0:n.type){case"Var":case"Let":case"Const":{Object.assign(this,new VariableDeclaration(e));break}case"Async":case"Function":{Object.assign(this,new FunctionDeclaration(e));break}case"Class":{Object.assign(this,new ClassDeclaration(e));break}}}}class StatementListItem{constructor(e){var n;switch((n=e.lookahead)==null?void 0:n.type){case"Var":case"Let":case"Const":case"Async":case"Function":case"Class":{Object.assign(this,new Declaration(e));break}case"If":case"Do":case"While":case"For":case"Switch":case"Continue":case"Break":case"Return":case"With":case"Identifier":case"Throw":case"Try":case"Debugger":{Object.assign(this,new Statement(e));break}}}}class StatementList{constructor(e,n){t(this,"body");var s,o,c;const i=[];for(;e.tokenizer.isEOF()===!1&&!(n!=null&&n.includes(String((s=e.lookahead)==null?void 0:s.type)));){const l=new StatementListItem(e);for(l!==void 0&&i.push(l),((o=e.lookahead)==null?void 0:o.type)===";"&&e.eat(";");((c=e.lookahead)==null?void 0:c.type)===";";)i.push(new EmptyStatement(e))}this.body=i}}class Program{constructor(e){t(this,"type","Program");t(this,"body");this.body=new StatementList(e).body}}class Parser{constructor(){t(this,"syntax");t(this,"tokenizer");t(this,"lookahead");this.syntax="",this.tokenizer=new Tokenizer(""),this.lookahead=null}parse(e){return this.lookahead=null,this.syntax="",this.syntax=e,this.tokenizer=new Tokenizer(this.syntax),this.lookahead=this.tokenizer.getNextToken(),new Program(this)}eat(e){const n=this.lookahead;if(n===null)throw new SyntaxError(`Unexpected end of input, expected: "${e}"`);if(n.type!==e)throw new SyntaxError(`Unexpected token: "${n.value}", expected: "${e}"`);return this.lookahead=this.tokenizer.getNextToken(),n}}class Executor extends Parser{constructor(){super(),Error.prepareStackTrace=(a,e)=>e.map(n=>({line:n.getLineNumber(),column:n.getColumnNumber(),fileName:n.getFileName(),functionName:n.getFunctionName(),methodName:n.getMethodName(),typeName:n.getTypeName(),isToplevel:n.isToplevel(),isEval:n.isEval(),isNative:n.isNative(),isConstructor:n.isConstructor(),evalOrigin:n.getEvalOrigin(),this:n.getThis()}))}execute(syntax){this.parse(syntax);try{return eval(this.tokenizer.executable)}catch(a){console.error(a)}}}const parser=new Parser,executor=new Executor;typeof window<"u"&&(customElements.define("vi-script",class extends HTMLElement{constructor(){super()}connectedCallback(){setTimeout(()=>{var e;const a=(e=this.childNodes.item(0).textContent)==null?void 0:e.trim();this.innerHTML="",a&&executor.execute(a)})}}),window.VietScript={parser,executor}),exports.Parser=Parser,exports.Tokenizer=Tokenizer,exports.default=parser,exports.executor=executor,Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
